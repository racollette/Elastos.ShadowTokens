{"ast":null,"code":"'use strict';\n\nvar _ = require('lodash');\n\nvar $ = require('../util/preconditions');\n\nvar BufferUtil = require('../util/buffer');\n\nvar BN = require('../crypto/bn');\n\nvar BufferReader = function BufferReader(buf) {\n  if (!(this instanceof BufferReader)) {\n    return new BufferReader(buf);\n  }\n\n  if (_.isUndefined(buf)) {\n    return;\n  }\n\n  if (Buffer.isBuffer(buf)) {\n    this.set({\n      buf: buf\n    });\n  } else if (_.isString(buf)) {\n    var b = Buffer.from(buf, 'hex');\n    if (b.length * 2 != buf.length) throw new TypeError('Invalid hex string');\n    this.set({\n      buf: b\n    });\n  } else if (_.isObject(buf)) {\n    var obj = buf;\n    this.set(obj);\n  } else {\n    throw new TypeError('Unrecognized argument for BufferReader');\n  }\n};\n\nBufferReader.prototype.set = function (obj) {\n  this.buf = obj.buf || this.buf || undefined;\n  this.pos = obj.pos || this.pos || 0;\n  return this;\n};\n\nBufferReader.prototype.eof = function () {\n  return this.pos >= this.buf.length;\n};\n\nBufferReader.prototype.finished = BufferReader.prototype.eof;\n\nBufferReader.prototype.read = function (len) {\n  $.checkArgument(!_.isUndefined(len), 'Must specify a length');\n  var buf = this.buf.slice(this.pos, this.pos + len);\n  this.pos = this.pos + len;\n  return buf;\n};\n\nBufferReader.prototype.readAll = function () {\n  var buf = this.buf.slice(this.pos, this.buf.length);\n  this.pos = this.buf.length;\n  return buf;\n};\n\nBufferReader.prototype.readUInt8 = function () {\n  var val = this.buf.readUInt8(this.pos);\n  this.pos = this.pos + 1;\n  return val;\n};\n\nBufferReader.prototype.readUInt16BE = function () {\n  var val = this.buf.readUInt16BE(this.pos);\n  this.pos = this.pos + 2;\n  return val;\n};\n\nBufferReader.prototype.readUInt16LE = function () {\n  var val = this.buf.readUInt16LE(this.pos);\n  this.pos = this.pos + 2;\n  return val;\n};\n\nBufferReader.prototype.readUInt32BE = function () {\n  var val = this.buf.readUInt32BE(this.pos);\n  this.pos = this.pos + 4;\n  return val;\n};\n\nBufferReader.prototype.readUInt32LE = function () {\n  var val = this.buf.readUInt32LE(this.pos);\n  this.pos = this.pos + 4;\n  return val;\n};\n\nBufferReader.prototype.readInt32LE = function () {\n  var val = this.buf.readInt32LE(this.pos);\n  this.pos = this.pos + 4;\n  return val;\n};\n\nBufferReader.prototype.readUInt64BEBN = function () {\n  var buf = this.buf.slice(this.pos, this.pos + 8);\n  var bn = BN.fromBuffer(buf);\n  this.pos = this.pos + 8;\n  return bn;\n};\n\nBufferReader.prototype.readUInt64LEBN = function () {\n  var second = this.buf.readUInt32LE(this.pos);\n  var first = this.buf.readUInt32LE(this.pos + 4);\n  var combined = first * 0x100000000 + second; // Instantiating an instance of BN with a number is faster than with an\n  // array or string. However, the maximum safe number for a double precision\n  // floating point is 2 ^ 52 - 1 (0x1fffffffffffff), thus we can safely use\n  // non-floating point numbers less than this amount (52 bits). And in the case\n  // that the number is larger, we can instatiate an instance of BN by passing\n  // an array from the buffer (slower) and specifying the endianness.\n\n  var bn;\n\n  if (combined <= 0x1fffffffffffff) {\n    bn = new BN(combined);\n  } else {\n    var data = Array.prototype.slice.call(this.buf, this.pos, this.pos + 8);\n    bn = new BN(data, 10, 'le');\n  }\n\n  this.pos = this.pos + 8;\n  return bn;\n};\n\nBufferReader.prototype.readVarintNum = function () {\n  var first = this.readUInt8();\n\n  switch (first) {\n    case 0xFD:\n      return this.readUInt16LE();\n\n    case 0xFE:\n      return this.readUInt32LE();\n\n    case 0xFF:\n      var bn = this.readUInt64LEBN();\n      var n = bn.toNumber();\n\n      if (n <= Math.pow(2, 53)) {\n        return n;\n      } else {\n        throw new Error('number too large to retain precision - use readVarintBN');\n      }\n\n      break;\n\n    default:\n      return first;\n  }\n};\n/**\n * reads a length prepended buffer\n */\n\n\nBufferReader.prototype.readVarLengthBuffer = function () {\n  var len = this.readVarintNum();\n  var buf = this.read(len);\n  $.checkState(buf.length === len, 'Invalid length while reading varlength buffer. ' + 'Expected to read: ' + len + ' and read ' + buf.length);\n  return buf;\n};\n\nBufferReader.prototype.readVarintBuf = function () {\n  var first = this.buf.readUInt8(this.pos);\n\n  switch (first) {\n    case 0xFD:\n      return this.read(1 + 2);\n\n    case 0xFE:\n      return this.read(1 + 4);\n\n    case 0xFF:\n      return this.read(1 + 8);\n\n    default:\n      return this.read(1);\n  }\n};\n\nBufferReader.prototype.readVarintBN = function () {\n  var first = this.readUInt8();\n\n  switch (first) {\n    case 0xFD:\n      return new BN(this.readUInt16LE());\n\n    case 0xFE:\n      return new BN(this.readUInt32LE());\n\n    case 0xFF:\n      return this.readUInt64LEBN();\n\n    default:\n      return new BN(first);\n  }\n};\n\nBufferReader.prototype.reverse = function () {\n  var buf = Buffer.alloc(this.buf.length);\n\n  for (var i = 0; i < buf.length; i++) {\n    buf[i] = this.buf[this.buf.length - 1 - i];\n  }\n\n  this.buf = buf;\n  return this;\n};\n\nBufferReader.prototype.readReverse = function (len) {\n  if (_.isUndefined(len)) {\n    len = this.buf.length;\n  }\n\n  var buf = this.buf.slice(this.pos, this.pos + len);\n  this.pos = this.pos + len;\n  return BufferUtil.reverse(buf);\n};\n\nmodule.exports = BufferReader;","map":{"version":3,"sources":["/home/ryan/dev/defi/shadowtoken2/node_modules/bitcore-lib-cash/lib/encoding/bufferreader.js"],"names":["_","require","$","BufferUtil","BN","BufferReader","buf","isUndefined","Buffer","isBuffer","set","isString","b","from","length","TypeError","isObject","obj","prototype","undefined","pos","eof","finished","read","len","checkArgument","slice","readAll","readUInt8","val","readUInt16BE","readUInt16LE","readUInt32BE","readUInt32LE","readInt32LE","readUInt64BEBN","bn","fromBuffer","readUInt64LEBN","second","first","combined","data","Array","call","readVarintNum","n","toNumber","Math","pow","Error","readVarLengthBuffer","checkState","readVarintBuf","readVarintBN","reverse","alloc","i","readReverse","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,CAAC,GAAGC,OAAO,CAAC,QAAD,CAAf;;AACA,IAAIC,CAAC,GAAGD,OAAO,CAAC,uBAAD,CAAf;;AACA,IAAIE,UAAU,GAAGF,OAAO,CAAC,gBAAD,CAAxB;;AACA,IAAIG,EAAE,GAAGH,OAAO,CAAC,cAAD,CAAhB;;AAEA,IAAII,YAAY,GAAG,SAASA,YAAT,CAAsBC,GAAtB,EAA2B;AAC5C,MAAI,EAAE,gBAAgBD,YAAlB,CAAJ,EAAqC;AACnC,WAAO,IAAIA,YAAJ,CAAiBC,GAAjB,CAAP;AACD;;AACD,MAAIN,CAAC,CAACO,WAAF,CAAcD,GAAd,CAAJ,EAAwB;AACtB;AACD;;AACD,MAAIE,MAAM,CAACC,QAAP,CAAgBH,GAAhB,CAAJ,EAA0B;AACxB,SAAKI,GAAL,CAAS;AACPJ,MAAAA,GAAG,EAAEA;AADE,KAAT;AAGD,GAJD,MAIO,IAAIN,CAAC,CAACW,QAAF,CAAWL,GAAX,CAAJ,EAAqB;AAC1B,QAAIM,CAAC,GAAGJ,MAAM,CAACK,IAAP,CAAYP,GAAZ,EAAiB,KAAjB,CAAR;AACA,QAAIM,CAAC,CAACE,MAAF,GAAW,CAAX,IAAgBR,GAAG,CAACQ,MAAxB,EACE,MAAM,IAAIC,SAAJ,CAAc,oBAAd,CAAN;AAEF,SAAKL,GAAL,CAAS;AACPJ,MAAAA,GAAG,EAAEM;AADE,KAAT;AAGD,GARM,MAQA,IAAIZ,CAAC,CAACgB,QAAF,CAAWV,GAAX,CAAJ,EAAqB;AAC1B,QAAIW,GAAG,GAAGX,GAAV;AACA,SAAKI,GAAL,CAASO,GAAT;AACD,GAHM,MAGA;AACL,UAAM,IAAIF,SAAJ,CAAc,wCAAd,CAAN;AACD;AACF,CAzBD;;AA2BAV,YAAY,CAACa,SAAb,CAAuBR,GAAvB,GAA6B,UAASO,GAAT,EAAc;AACzC,OAAKX,GAAL,GAAWW,GAAG,CAACX,GAAJ,IAAW,KAAKA,GAAhB,IAAuBa,SAAlC;AACA,OAAKC,GAAL,GAAWH,GAAG,CAACG,GAAJ,IAAW,KAAKA,GAAhB,IAAuB,CAAlC;AACA,SAAO,IAAP;AACD,CAJD;;AAMAf,YAAY,CAACa,SAAb,CAAuBG,GAAvB,GAA6B,YAAW;AACtC,SAAO,KAAKD,GAAL,IAAY,KAAKd,GAAL,CAASQ,MAA5B;AACD,CAFD;;AAIAT,YAAY,CAACa,SAAb,CAAuBI,QAAvB,GAAkCjB,YAAY,CAACa,SAAb,CAAuBG,GAAzD;;AAEAhB,YAAY,CAACa,SAAb,CAAuBK,IAAvB,GAA8B,UAASC,GAAT,EAAc;AAC1CtB,EAAAA,CAAC,CAACuB,aAAF,CAAgB,CAACzB,CAAC,CAACO,WAAF,CAAciB,GAAd,CAAjB,EAAqC,uBAArC;AACA,MAAIlB,GAAG,GAAG,KAAKA,GAAL,CAASoB,KAAT,CAAe,KAAKN,GAApB,EAAyB,KAAKA,GAAL,GAAWI,GAApC,CAAV;AACA,OAAKJ,GAAL,GAAW,KAAKA,GAAL,GAAWI,GAAtB;AACA,SAAOlB,GAAP;AACD,CALD;;AAOAD,YAAY,CAACa,SAAb,CAAuBS,OAAvB,GAAiC,YAAW;AAC1C,MAAIrB,GAAG,GAAG,KAAKA,GAAL,CAASoB,KAAT,CAAe,KAAKN,GAApB,EAAyB,KAAKd,GAAL,CAASQ,MAAlC,CAAV;AACA,OAAKM,GAAL,GAAW,KAAKd,GAAL,CAASQ,MAApB;AACA,SAAOR,GAAP;AACD,CAJD;;AAMAD,YAAY,CAACa,SAAb,CAAuBU,SAAvB,GAAmC,YAAW;AAC5C,MAAIC,GAAG,GAAG,KAAKvB,GAAL,CAASsB,SAAT,CAAmB,KAAKR,GAAxB,CAAV;AACA,OAAKA,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;AACA,SAAOS,GAAP;AACD,CAJD;;AAMAxB,YAAY,CAACa,SAAb,CAAuBY,YAAvB,GAAsC,YAAW;AAC/C,MAAID,GAAG,GAAG,KAAKvB,GAAL,CAASwB,YAAT,CAAsB,KAAKV,GAA3B,CAAV;AACA,OAAKA,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;AACA,SAAOS,GAAP;AACD,CAJD;;AAMAxB,YAAY,CAACa,SAAb,CAAuBa,YAAvB,GAAsC,YAAW;AAC/C,MAAIF,GAAG,GAAG,KAAKvB,GAAL,CAASyB,YAAT,CAAsB,KAAKX,GAA3B,CAAV;AACA,OAAKA,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;AACA,SAAOS,GAAP;AACD,CAJD;;AAMAxB,YAAY,CAACa,SAAb,CAAuBc,YAAvB,GAAsC,YAAW;AAC/C,MAAIH,GAAG,GAAG,KAAKvB,GAAL,CAAS0B,YAAT,CAAsB,KAAKZ,GAA3B,CAAV;AACA,OAAKA,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;AACA,SAAOS,GAAP;AACD,CAJD;;AAMAxB,YAAY,CAACa,SAAb,CAAuBe,YAAvB,GAAsC,YAAW;AAC/C,MAAIJ,GAAG,GAAG,KAAKvB,GAAL,CAAS2B,YAAT,CAAsB,KAAKb,GAA3B,CAAV;AACA,OAAKA,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;AACA,SAAOS,GAAP;AACD,CAJD;;AAMAxB,YAAY,CAACa,SAAb,CAAuBgB,WAAvB,GAAqC,YAAW;AAC9C,MAAIL,GAAG,GAAG,KAAKvB,GAAL,CAAS4B,WAAT,CAAqB,KAAKd,GAA1B,CAAV;AACA,OAAKA,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;AACA,SAAOS,GAAP;AACD,CAJD;;AAMAxB,YAAY,CAACa,SAAb,CAAuBiB,cAAvB,GAAwC,YAAW;AACjD,MAAI7B,GAAG,GAAG,KAAKA,GAAL,CAASoB,KAAT,CAAe,KAAKN,GAApB,EAAyB,KAAKA,GAAL,GAAW,CAApC,CAAV;AACA,MAAIgB,EAAE,GAAGhC,EAAE,CAACiC,UAAH,CAAc/B,GAAd,CAAT;AACA,OAAKc,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;AACA,SAAOgB,EAAP;AACD,CALD;;AAOA/B,YAAY,CAACa,SAAb,CAAuBoB,cAAvB,GAAwC,YAAW;AACjD,MAAIC,MAAM,GAAG,KAAKjC,GAAL,CAAS2B,YAAT,CAAsB,KAAKb,GAA3B,CAAb;AACA,MAAIoB,KAAK,GAAG,KAAKlC,GAAL,CAAS2B,YAAT,CAAsB,KAAKb,GAAL,GAAW,CAAjC,CAAZ;AACA,MAAIqB,QAAQ,GAAID,KAAK,GAAG,WAAT,GAAwBD,MAAvC,CAHiD,CAIjD;AACA;AACA;AACA;AACA;AACA;;AACA,MAAIH,EAAJ;;AACA,MAAIK,QAAQ,IAAI,gBAAhB,EAAkC;AAChCL,IAAAA,EAAE,GAAG,IAAIhC,EAAJ,CAAOqC,QAAP,CAAL;AACD,GAFD,MAEO;AACL,QAAIC,IAAI,GAAGC,KAAK,CAACzB,SAAN,CAAgBQ,KAAhB,CAAsBkB,IAAtB,CAA2B,KAAKtC,GAAhC,EAAqC,KAAKc,GAA1C,EAA+C,KAAKA,GAAL,GAAW,CAA1D,CAAX;AACAgB,IAAAA,EAAE,GAAG,IAAIhC,EAAJ,CAAOsC,IAAP,EAAa,EAAb,EAAiB,IAAjB,CAAL;AACD;;AACD,OAAKtB,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;AACA,SAAOgB,EAAP;AACD,CAnBD;;AAqBA/B,YAAY,CAACa,SAAb,CAAuB2B,aAAvB,GAAuC,YAAW;AAChD,MAAIL,KAAK,GAAG,KAAKZ,SAAL,EAAZ;;AACA,UAAQY,KAAR;AACE,SAAK,IAAL;AACE,aAAO,KAAKT,YAAL,EAAP;;AACF,SAAK,IAAL;AACE,aAAO,KAAKE,YAAL,EAAP;;AACF,SAAK,IAAL;AACE,UAAIG,EAAE,GAAG,KAAKE,cAAL,EAAT;AACA,UAAIQ,CAAC,GAAGV,EAAE,CAACW,QAAH,EAAR;;AACA,UAAID,CAAC,IAAIE,IAAI,CAACC,GAAL,CAAS,CAAT,EAAY,EAAZ,CAAT,EAA0B;AACxB,eAAOH,CAAP;AACD,OAFD,MAEO;AACL,cAAM,IAAII,KAAJ,CAAU,yDAAV,CAAN;AACD;;AACD;;AACF;AACE,aAAOV,KAAP;AAfJ;AAiBD,CAnBD;AAqBA;;;;;AAGAnC,YAAY,CAACa,SAAb,CAAuBiC,mBAAvB,GAA6C,YAAW;AACtD,MAAI3B,GAAG,GAAG,KAAKqB,aAAL,EAAV;AACA,MAAIvC,GAAG,GAAG,KAAKiB,IAAL,CAAUC,GAAV,CAAV;AACAtB,EAAAA,CAAC,CAACkD,UAAF,CAAa9C,GAAG,CAACQ,MAAJ,KAAeU,GAA5B,EAAiC,oDAC/B,oBAD+B,GACRA,GADQ,GACF,YADE,GACalB,GAAG,CAACQ,MADlD;AAEA,SAAOR,GAAP;AACD,CAND;;AAQAD,YAAY,CAACa,SAAb,CAAuBmC,aAAvB,GAAuC,YAAW;AAChD,MAAIb,KAAK,GAAG,KAAKlC,GAAL,CAASsB,SAAT,CAAmB,KAAKR,GAAxB,CAAZ;;AACA,UAAQoB,KAAR;AACE,SAAK,IAAL;AACE,aAAO,KAAKjB,IAAL,CAAU,IAAI,CAAd,CAAP;;AACF,SAAK,IAAL;AACE,aAAO,KAAKA,IAAL,CAAU,IAAI,CAAd,CAAP;;AACF,SAAK,IAAL;AACE,aAAO,KAAKA,IAAL,CAAU,IAAI,CAAd,CAAP;;AACF;AACE,aAAO,KAAKA,IAAL,CAAU,CAAV,CAAP;AARJ;AAUD,CAZD;;AAcAlB,YAAY,CAACa,SAAb,CAAuBoC,YAAvB,GAAsC,YAAW;AAC/C,MAAId,KAAK,GAAG,KAAKZ,SAAL,EAAZ;;AACA,UAAQY,KAAR;AACE,SAAK,IAAL;AACE,aAAO,IAAIpC,EAAJ,CAAO,KAAK2B,YAAL,EAAP,CAAP;;AACF,SAAK,IAAL;AACE,aAAO,IAAI3B,EAAJ,CAAO,KAAK6B,YAAL,EAAP,CAAP;;AACF,SAAK,IAAL;AACE,aAAO,KAAKK,cAAL,EAAP;;AACF;AACE,aAAO,IAAIlC,EAAJ,CAAOoC,KAAP,CAAP;AARJ;AAUD,CAZD;;AAcAnC,YAAY,CAACa,SAAb,CAAuBqC,OAAvB,GAAiC,YAAW;AAC1C,MAAIjD,GAAG,GAAGE,MAAM,CAACgD,KAAP,CAAa,KAAKlD,GAAL,CAASQ,MAAtB,CAAV;;AACA,OAAK,IAAI2C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnD,GAAG,CAACQ,MAAxB,EAAgC2C,CAAC,EAAjC,EAAqC;AACnCnD,IAAAA,GAAG,CAACmD,CAAD,CAAH,GAAS,KAAKnD,GAAL,CAAS,KAAKA,GAAL,CAASQ,MAAT,GAAkB,CAAlB,GAAsB2C,CAA/B,CAAT;AACD;;AACD,OAAKnD,GAAL,GAAWA,GAAX;AACA,SAAO,IAAP;AACD,CAPD;;AASAD,YAAY,CAACa,SAAb,CAAuBwC,WAAvB,GAAqC,UAASlC,GAAT,EAAc;AACjD,MAAIxB,CAAC,CAACO,WAAF,CAAciB,GAAd,CAAJ,EAAwB;AACtBA,IAAAA,GAAG,GAAG,KAAKlB,GAAL,CAASQ,MAAf;AACD;;AACD,MAAIR,GAAG,GAAG,KAAKA,GAAL,CAASoB,KAAT,CAAe,KAAKN,GAApB,EAAyB,KAAKA,GAAL,GAAWI,GAApC,CAAV;AACA,OAAKJ,GAAL,GAAW,KAAKA,GAAL,GAAWI,GAAtB;AACA,SAAOrB,UAAU,CAACoD,OAAX,CAAmBjD,GAAnB,CAAP;AACD,CAPD;;AASAqD,MAAM,CAACC,OAAP,GAAiBvD,YAAjB","sourcesContent":["'use strict';\n\nvar _ = require('lodash');\nvar $ = require('../util/preconditions');\nvar BufferUtil = require('../util/buffer');\nvar BN = require('../crypto/bn');\n\nvar BufferReader = function BufferReader(buf) {\n  if (!(this instanceof BufferReader)) {\n    return new BufferReader(buf);\n  }\n  if (_.isUndefined(buf)) {\n    return;\n  }\n  if (Buffer.isBuffer(buf)) {\n    this.set({\n      buf: buf\n    });\n  } else if (_.isString(buf)) {\n    var b = Buffer.from(buf, 'hex');\n    if (b.length * 2 != buf.length) \n      throw new TypeError('Invalid hex string');\n\n    this.set({\n      buf: b\n    });\n  } else if (_.isObject(buf)) {\n    var obj = buf;\n    this.set(obj);\n  } else {\n    throw new TypeError('Unrecognized argument for BufferReader');\n  }\n};\n\nBufferReader.prototype.set = function(obj) {\n  this.buf = obj.buf || this.buf || undefined;\n  this.pos = obj.pos || this.pos || 0;\n  return this;\n};\n\nBufferReader.prototype.eof = function() {\n  return this.pos >= this.buf.length;\n};\n\nBufferReader.prototype.finished = BufferReader.prototype.eof;\n\nBufferReader.prototype.read = function(len) {\n  $.checkArgument(!_.isUndefined(len), 'Must specify a length');\n  var buf = this.buf.slice(this.pos, this.pos + len);\n  this.pos = this.pos + len;\n  return buf;\n};\n\nBufferReader.prototype.readAll = function() {\n  var buf = this.buf.slice(this.pos, this.buf.length);\n  this.pos = this.buf.length;\n  return buf;\n};\n\nBufferReader.prototype.readUInt8 = function() {\n  var val = this.buf.readUInt8(this.pos);\n  this.pos = this.pos + 1;\n  return val;\n};\n\nBufferReader.prototype.readUInt16BE = function() {\n  var val = this.buf.readUInt16BE(this.pos);\n  this.pos = this.pos + 2;\n  return val;\n};\n\nBufferReader.prototype.readUInt16LE = function() {\n  var val = this.buf.readUInt16LE(this.pos);\n  this.pos = this.pos + 2;\n  return val;\n};\n\nBufferReader.prototype.readUInt32BE = function() {\n  var val = this.buf.readUInt32BE(this.pos);\n  this.pos = this.pos + 4;\n  return val;\n};\n\nBufferReader.prototype.readUInt32LE = function() {\n  var val = this.buf.readUInt32LE(this.pos);\n  this.pos = this.pos + 4;\n  return val;\n};\n\nBufferReader.prototype.readInt32LE = function() {\n  var val = this.buf.readInt32LE(this.pos);\n  this.pos = this.pos + 4;\n  return val;\n};\n\nBufferReader.prototype.readUInt64BEBN = function() {\n  var buf = this.buf.slice(this.pos, this.pos + 8);\n  var bn = BN.fromBuffer(buf);\n  this.pos = this.pos + 8;\n  return bn;\n};\n\nBufferReader.prototype.readUInt64LEBN = function() {\n  var second = this.buf.readUInt32LE(this.pos);\n  var first = this.buf.readUInt32LE(this.pos + 4);\n  var combined = (first * 0x100000000) + second;\n  // Instantiating an instance of BN with a number is faster than with an\n  // array or string. However, the maximum safe number for a double precision\n  // floating point is 2 ^ 52 - 1 (0x1fffffffffffff), thus we can safely use\n  // non-floating point numbers less than this amount (52 bits). And in the case\n  // that the number is larger, we can instatiate an instance of BN by passing\n  // an array from the buffer (slower) and specifying the endianness.\n  var bn;\n  if (combined <= 0x1fffffffffffff) {\n    bn = new BN(combined);\n  } else {\n    var data = Array.prototype.slice.call(this.buf, this.pos, this.pos + 8);\n    bn = new BN(data, 10, 'le');\n  }\n  this.pos = this.pos + 8;\n  return bn;\n};\n\nBufferReader.prototype.readVarintNum = function() {\n  var first = this.readUInt8();\n  switch (first) {\n    case 0xFD:\n      return this.readUInt16LE();\n    case 0xFE:\n      return this.readUInt32LE();\n    case 0xFF:\n      var bn = this.readUInt64LEBN();\n      var n = bn.toNumber();\n      if (n <= Math.pow(2, 53)) {\n        return n;\n      } else {\n        throw new Error('number too large to retain precision - use readVarintBN');\n      }\n      break;\n    default:\n      return first;\n  }\n};\n\n/**\n * reads a length prepended buffer\n */\nBufferReader.prototype.readVarLengthBuffer = function() {\n  var len = this.readVarintNum();\n  var buf = this.read(len);\n  $.checkState(buf.length === len, 'Invalid length while reading varlength buffer. ' +\n    'Expected to read: ' + len + ' and read ' + buf.length);\n  return buf;\n};\n\nBufferReader.prototype.readVarintBuf = function() {\n  var first = this.buf.readUInt8(this.pos);\n  switch (first) {\n    case 0xFD:\n      return this.read(1 + 2);\n    case 0xFE:\n      return this.read(1 + 4);\n    case 0xFF:\n      return this.read(1 + 8);\n    default:\n      return this.read(1);\n  }\n};\n\nBufferReader.prototype.readVarintBN = function() {\n  var first = this.readUInt8();\n  switch (first) {\n    case 0xFD:\n      return new BN(this.readUInt16LE());\n    case 0xFE:\n      return new BN(this.readUInt32LE());\n    case 0xFF:\n      return this.readUInt64LEBN();\n    default:\n      return new BN(first);\n  }\n};\n\nBufferReader.prototype.reverse = function() {\n  var buf = Buffer.alloc(this.buf.length);\n  for (var i = 0; i < buf.length; i++) {\n    buf[i] = this.buf[this.buf.length - 1 - i];\n  }\n  this.buf = buf;\n  return this;\n};\n\nBufferReader.prototype.readReverse = function(len) {\n  if (_.isUndefined(len)) {\n    len = this.buf.length;\n  }\n  var buf = this.buf.slice(this.pos, this.pos + len);\n  this.pos = this.pos + len;\n  return BufferUtil.reverse(buf);\n};\n\nmodule.exports = BufferReader;\n"]},"metadata":{},"sourceType":"script"}