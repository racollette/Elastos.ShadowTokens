{"ast":null,"code":"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@babel/runtime/helpers/classCallCheck'), require('@babel/runtime/helpers/createClass'), require('websocket'), require('xhr2-cookies'), require('url-parse'), require('@babel/runtime/helpers/typeof'), require('lodash/isFunction'), require('lodash/isObject'), require('@babel/runtime/regenerator'), require('@babel/runtime/helpers/asyncToGenerator'), require('@babel/runtime/helpers/possibleConstructorReturn'), require('@babel/runtime/helpers/getPrototypeOf'), require('@babel/runtime/helpers/get'), require('@babel/runtime/helpers/inherits'), require('eventemitter3'), require('lodash/isArray'), require('http'), require('https')) : typeof define === 'function' && define.amd ? define(['exports', '@babel/runtime/helpers/classCallCheck', '@babel/runtime/helpers/createClass', 'websocket', 'xhr2-cookies', 'url-parse', '@babel/runtime/helpers/typeof', 'lodash/isFunction', 'lodash/isObject', '@babel/runtime/regenerator', '@babel/runtime/helpers/asyncToGenerator', '@babel/runtime/helpers/possibleConstructorReturn', '@babel/runtime/helpers/getPrototypeOf', '@babel/runtime/helpers/get', '@babel/runtime/helpers/inherits', 'eventemitter3', 'lodash/isArray', 'http', 'https'], factory) : (global = global || self, factory(global.Web3Providers = {}, global._classCallCheck, global._createClass, global.websocket, global.xhr2Cookies, global.URL, global._typeof, global.isFunction, global.isObject, global._regeneratorRuntime, global._asyncToGenerator, global._possibleConstructorReturn, global._getPrototypeOf, global._get, global._inherits, global.EventEmitter, global.isArray, global.http, global.https));\n})(this, function (exports, _classCallCheck, _createClass, websocket, xhr2Cookies, URL, _typeof, isFunction, isObject, _regeneratorRuntime, _asyncToGenerator, _possibleConstructorReturn, _getPrototypeOf, _get, _inherits, EventEmitter, isArray, http, https) {\n  'use strict';\n\n  _classCallCheck = _classCallCheck && _classCallCheck.hasOwnProperty('default') ? _classCallCheck['default'] : _classCallCheck;\n  _createClass = _createClass && _createClass.hasOwnProperty('default') ? _createClass['default'] : _createClass;\n  URL = URL && URL.hasOwnProperty('default') ? URL['default'] : URL;\n  _typeof = _typeof && _typeof.hasOwnProperty('default') ? _typeof['default'] : _typeof;\n  isFunction = isFunction && isFunction.hasOwnProperty('default') ? isFunction['default'] : isFunction;\n  isObject = isObject && isObject.hasOwnProperty('default') ? isObject['default'] : isObject;\n  _regeneratorRuntime = _regeneratorRuntime && _regeneratorRuntime.hasOwnProperty('default') ? _regeneratorRuntime['default'] : _regeneratorRuntime;\n  _asyncToGenerator = _asyncToGenerator && _asyncToGenerator.hasOwnProperty('default') ? _asyncToGenerator['default'] : _asyncToGenerator;\n  _possibleConstructorReturn = _possibleConstructorReturn && _possibleConstructorReturn.hasOwnProperty('default') ? _possibleConstructorReturn['default'] : _possibleConstructorReturn;\n  _getPrototypeOf = _getPrototypeOf && _getPrototypeOf.hasOwnProperty('default') ? _getPrototypeOf['default'] : _getPrototypeOf;\n  _get = _get && _get.hasOwnProperty('default') ? _get['default'] : _get;\n  _inherits = _inherits && _inherits.hasOwnProperty('default') ? _inherits['default'] : _inherits;\n  EventEmitter = EventEmitter && EventEmitter.hasOwnProperty('default') ? EventEmitter['default'] : EventEmitter;\n  isArray = isArray && isArray.hasOwnProperty('default') ? isArray['default'] : isArray;\n  http = http && http.hasOwnProperty('default') ? http['default'] : http;\n  https = https && https.hasOwnProperty('default') ? https['default'] : https;\n\n  var global = function () {\n    return this || (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' && self;\n  }() || new Function('return this')();\n\n  var ProviderResolver = function () {\n    function ProviderResolver(providersModuleFactory) {\n      _classCallCheck(this, ProviderResolver);\n\n      this.providersModuleFactory = providersModuleFactory;\n    }\n\n    _createClass(ProviderResolver, [{\n      key: \"resolve\",\n      value: function resolve(provider, net) {\n        if (!provider) {\n          return provider;\n        }\n\n        if (typeof provider === 'string') {\n          if (/^http(s)?:\\/\\//i.test(provider)) {\n            return this.providersModuleFactory.createHttpProvider(provider);\n          }\n\n          if (/^ws(s)?:\\/\\//i.test(provider)) {\n            return this.providersModuleFactory.createWebsocketProvider(provider);\n          }\n\n          if (provider && isObject(net) && isFunction(net.connect)) {\n            return this.providersModuleFactory.createIpcProvider(provider, net);\n          }\n        }\n\n        if (provider.sendPayload && provider.subscribe) {\n          return provider;\n        }\n\n        if (provider.host === 'Web3EthereumProvider') {\n          return provider;\n        }\n\n        if (typeof global.mist !== 'undefined' && provider.constructor.name === 'EthereumProvider') {\n          return this.providersModuleFactory.createMistEthereumProvider(provider);\n        }\n\n        if (provider.isEIP1193) {\n          return this.providersModuleFactory.createWeb3EthereumProvider(provider);\n        }\n\n        if (this.isMetamaskInpageProvider(provider)) {\n          return this.providersModuleFactory.createMetamaskProvider(provider);\n        }\n\n        return this.providersModuleFactory.createCustomProvider(provider);\n      }\n    }, {\n      key: \"isMetamaskInpageProvider\",\n      value: function isMetamaskInpageProvider(provider) {\n        return provider.constructor.name === 'MetamaskInpageProvider';\n      }\n    }]);\n\n    return ProviderResolver;\n  }();\n\n  var messageId = 0;\n\n  var JsonRpcMapper = function () {\n    function JsonRpcMapper() {\n      _classCallCheck(this, JsonRpcMapper);\n    }\n\n    _createClass(JsonRpcMapper, null, [{\n      key: \"toPayload\",\n      value: function toPayload(method, params) {\n        if (!method) {\n          throw new Error(\"JSONRPC method should be specified for params: \\\"\".concat(JSON.stringify(params), \"\\\"!\"));\n        }\n\n        var id = messageId;\n        messageId++;\n        return {\n          jsonrpc: '2.0',\n          id: id,\n          method: method,\n          params: params || []\n        };\n      }\n    }]);\n\n    return JsonRpcMapper;\n  }();\n\n  var JsonRpcResponseValidator = function () {\n    function JsonRpcResponseValidator() {\n      _classCallCheck(this, JsonRpcResponseValidator);\n    }\n\n    _createClass(JsonRpcResponseValidator, null, [{\n      key: \"validate\",\n      value: function validate(response) {\n        var payload = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n        if (isObject(response)) {\n          if (response.error) {\n            if (response.error instanceof Error) {\n              return new Error(\"Node error: \".concat(response.error.message));\n            }\n\n            return new Error(\"Node error: \".concat(JSON.stringify(response.error)));\n          }\n\n          if (payload && response.id !== payload.id) {\n            return new Error(\"Validation error: Invalid JSON-RPC response ID (request: \".concat(payload.id, \" / response: \").concat(response.id, \")\"));\n          }\n\n          if (response.result === undefined) {\n            return new Error('Validation error: Undefined JSON-RPC result');\n          }\n\n          return true;\n        }\n\n        return new Error('Validation error: Response should be of type Object');\n      }\n    }]);\n\n    return JsonRpcResponseValidator;\n  }();\n\n  var AbstractSocketProvider = function (_EventEmitter) {\n    _inherits(AbstractSocketProvider, _EventEmitter);\n\n    function AbstractSocketProvider(connection, timeout) {\n      var _this;\n\n      _classCallCheck(this, AbstractSocketProvider);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(AbstractSocketProvider).call(this));\n      _this.connection = connection;\n      _this.timeout = timeout;\n      _this.subscriptions = new Map();\n\n      _this.registerEventListeners();\n\n      _this.READY = 'ready';\n      _this.CONNECT = 'connect';\n      _this.ERROR = 'error';\n      _this.CLOSE = 'close';\n      _this.SOCKET_MESSAGE = 'socket_message';\n      _this.SOCKET_READY = 'socket_ready';\n      _this.SOCKET_CLOSE = 'socket_close';\n      _this.SOCKET_ERROR = 'socket_error';\n      _this.SOCKET_CONNECT = 'socket_connect';\n      _this.SOCKET_NETWORK_CHANGED = 'socket_networkChanged';\n      _this.SOCKET_ACCOUNTS_CHANGED = 'socket_accountsChanged';\n      return _this;\n    }\n\n    _createClass(AbstractSocketProvider, [{\n      key: \"supportsSubscriptions\",\n      value: function supportsSubscriptions() {\n        return true;\n      }\n    }, {\n      key: \"registerEventListeners\",\n      value: function registerEventListeners() {}\n    }, {\n      key: \"removeAllSocketListeners\",\n      value: function removeAllSocketListeners() {\n        this.removeAllListeners(this.SOCKET_MESSAGE);\n        this.removeAllListeners(this.SOCKET_READY);\n        this.removeAllListeners(this.SOCKET_CLOSE);\n        this.removeAllListeners(this.SOCKET_ERROR);\n        this.removeAllListeners(this.SOCKET_CONNECT);\n      }\n    }, {\n      key: \"disconnect\",\n      value: function disconnect(code, reason) {}\n    }, {\n      key: \"send\",\n      value: function () {\n        var _send = _asyncToGenerator(_regeneratorRuntime.mark(function _callee(method, parameters) {\n          var response, validationResult;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return this.sendPayload(JsonRpcMapper.toPayload(method, parameters));\n\n                case 2:\n                  response = _context.sent;\n                  validationResult = JsonRpcResponseValidator.validate(response);\n\n                  if (!(validationResult instanceof Error)) {\n                    _context.next = 6;\n                    break;\n                  }\n\n                  throw validationResult;\n\n                case 6:\n                  return _context.abrupt(\"return\", response.result);\n\n                case 7:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        function send(_x, _x2) {\n          return _send.apply(this, arguments);\n        }\n\n        return send;\n      }()\n    }, {\n      key: \"sendBatch\",\n      value: function sendBatch(methods, moduleInstance) {\n        var payload = [];\n        methods.forEach(function (method) {\n          method.beforeExecution(moduleInstance);\n          payload.push(JsonRpcMapper.toPayload(method.rpcMethod, method.parameters));\n        });\n        return this.sendPayload(payload);\n      }\n    }, {\n      key: \"onReady\",\n      value: function onReady(event) {\n        this.emit(this.READY, event);\n        this.emit(this.SOCKET_READY, event);\n      }\n    }, {\n      key: \"onError\",\n      value: function onError(error) {\n        this.emit(this.ERROR, error);\n        this.emit(this.SOCKET_ERROR, error);\n        this.removeAllSocketListeners();\n      }\n    }, {\n      key: \"onClose\",\n      value: function onClose() {\n        var error = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n        this.emit(this.CLOSE, error);\n        this.emit(this.SOCKET_CLOSE, error);\n        this.removeAllSocketListeners();\n        this.removeAllListeners();\n      }\n    }, {\n      key: \"onConnect\",\n      value: function () {\n        var _onConnect = _asyncToGenerator(_regeneratorRuntime.mark(function _callee2() {\n          var subscriptionId, value, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, item;\n\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  if (!(this.subscriptions.size > 0)) {\n                    _context2.next = 31;\n                    break;\n                  }\n\n                  _iteratorNormalCompletion = true;\n                  _didIteratorError = false;\n                  _iteratorError = undefined;\n                  _context2.prev = 4;\n                  _iterator = this.subscriptions[Symbol.iterator]();\n\n                case 6:\n                  if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                    _context2.next = 17;\n                    break;\n                  }\n\n                  item = _step.value;\n                  value = item[1];\n                  _context2.next = 11;\n                  return this.subscribe(value.subscribeMethod, value.parameters[0], value.parameters.slice(1));\n\n                case 11:\n                  subscriptionId = _context2.sent;\n\n                  if (item[0] !== subscriptionId) {\n                    this.subscriptions.delete(subscriptionId);\n                  }\n\n                  value.id = subscriptionId;\n\n                case 14:\n                  _iteratorNormalCompletion = true;\n                  _context2.next = 6;\n                  break;\n\n                case 17:\n                  _context2.next = 23;\n                  break;\n\n                case 19:\n                  _context2.prev = 19;\n                  _context2.t0 = _context2[\"catch\"](4);\n                  _didIteratorError = true;\n                  _iteratorError = _context2.t0;\n\n                case 23:\n                  _context2.prev = 23;\n                  _context2.prev = 24;\n\n                  if (!_iteratorNormalCompletion && _iterator.return != null) {\n                    _iterator.return();\n                  }\n\n                case 26:\n                  _context2.prev = 26;\n\n                  if (!_didIteratorError) {\n                    _context2.next = 29;\n                    break;\n                  }\n\n                  throw _iteratorError;\n\n                case 29:\n                  return _context2.finish(26);\n\n                case 30:\n                  return _context2.finish(23);\n\n                case 31:\n                  this.emit(this.SOCKET_CONNECT);\n                  this.emit(this.CONNECT);\n\n                case 33:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this, [[4, 19, 23, 31], [24,, 26, 30]]);\n        }));\n\n        function onConnect() {\n          return _onConnect.apply(this, arguments);\n        }\n\n        return onConnect;\n      }()\n    }, {\n      key: \"onMessage\",\n      value: function onMessage(response) {\n        var event;\n\n        if (!isObject(response)) {\n          response = JSON.parse(response);\n        }\n\n        if (isArray(response)) {\n          event = response[0].id;\n        } else if (typeof response.id === 'undefined') {\n          event = this.getSubscriptionEvent(response.params.subscription);\n          response = response.params;\n        } else {\n          event = response.id;\n        }\n\n        this.emit(this.SOCKET_MESSAGE, response);\n        this.emit(event, response);\n      }\n    }, {\n      key: \"reset\",\n      value: function reset() {\n        this.removeAllListeners();\n        this.registerEventListeners();\n      }\n    }, {\n      key: \"subscribe\",\n      value: function subscribe(subscribeMethod, subscriptionMethod, parameters) {\n        var _this2 = this;\n\n        parameters.unshift(subscriptionMethod);\n        return this.send(subscribeMethod, parameters).then(function (subscriptionId) {\n          _this2.subscriptions.set(subscriptionId, {\n            id: subscriptionId,\n            subscribeMethod: subscribeMethod,\n            parameters: parameters\n          });\n\n          return subscriptionId;\n        }).catch(function (error) {\n          throw new Error(\"Provider error: \".concat(error));\n        });\n      }\n    }, {\n      key: \"unsubscribe\",\n      value: function unsubscribe(subscriptionId, unsubscribeMethod) {\n        var _this3 = this;\n\n        if (this.hasSubscription(subscriptionId)) {\n          return this.send(unsubscribeMethod, [subscriptionId]).then(function (response) {\n            if (response) {\n              _this3.removeAllListeners(_this3.getSubscriptionEvent(subscriptionId));\n\n              _this3.subscriptions.delete(subscriptionId);\n            }\n\n            return response;\n          });\n        }\n\n        return Promise.reject(new Error(\"Provider error: Subscription with ID \".concat(subscriptionId, \" does not exist.\")));\n      }\n    }, {\n      key: \"clearSubscriptions\",\n      value: function clearSubscriptions() {\n        var _this4 = this;\n\n        var unsubscribeMethod = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n        if (this.subscriptions.size > 0) {\n          var unsubscribePromises = [];\n          var type = unsubscribeMethod.slice(0, 3);\n          this.subscriptions.forEach(function (value) {\n            if (type === '') {\n              unsubscribePromises.push(_this4.unsubscribe(value.id, \"\".concat(value.subscribeMethod.slice(0, 3), \"_unsubscribe\")));\n            } else if (type === value.subscribeMethod.slice(0, 3)) {\n              unsubscribePromises.push(_this4.unsubscribe(value.id, unsubscribeMethod));\n            }\n          });\n          return Promise.all(unsubscribePromises).then(function (results) {\n            if (results.includes(false)) {\n              throw new Error(\"Could not unsubscribe all subscriptions: \".concat(JSON.stringify(results)));\n            }\n\n            return true;\n          });\n        }\n\n        return Promise.resolve(true);\n      }\n    }, {\n      key: \"hasSubscription\",\n      value: function hasSubscription(subscriptionId) {\n        return typeof this.getSubscriptionEvent(subscriptionId) !== 'undefined';\n      }\n    }, {\n      key: \"getSubscriptionEvent\",\n      value: function getSubscriptionEvent(subscriptionId) {\n        if (this.subscriptions.get(subscriptionId)) {\n          return subscriptionId;\n        }\n\n        var event;\n        this.subscriptions.forEach(function (value, key) {\n          if (value.id === subscriptionId) {\n            event = key;\n          }\n        });\n        return event;\n      }\n    }, {\n      key: \"connected\",\n      get: function get() {}\n    }]);\n\n    return AbstractSocketProvider;\n  }(EventEmitter);\n\n  var WebsocketProvider = function (_AbstractSocketProvid) {\n    _inherits(WebsocketProvider, _AbstractSocketProvid);\n\n    function WebsocketProvider(connection, timeout) {\n      var _this;\n\n      var reconnectDelay = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 5000;\n\n      _classCallCheck(this, WebsocketProvider);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(WebsocketProvider).call(this, connection, timeout));\n      _this.host = _this.connection.url;\n      _this.reconnectDelay = reconnectDelay;\n      _this.reconnecting = false;\n      return _this;\n    }\n\n    _createClass(WebsocketProvider, [{\n      key: \"onConnect\",\n      value: function () {\n        var _onConnect = _asyncToGenerator(_regeneratorRuntime.mark(function _callee() {\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  if (this.reconnecting) {\n                    this.emit('reconnected');\n                  }\n\n                  _context.next = 3;\n                  return _get(_getPrototypeOf(WebsocketProvider.prototype), \"onConnect\", this).call(this);\n\n                case 3:\n                  this.reconnecting = false;\n\n                case 4:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        function onConnect() {\n          return _onConnect.apply(this, arguments);\n        }\n\n        return onConnect;\n      }()\n    }, {\n      key: \"onMessage\",\n      value: function onMessage(messageEvent) {\n        _get(_getPrototypeOf(WebsocketProvider.prototype), \"onMessage\", this).call(this, messageEvent.data);\n      }\n    }, {\n      key: \"onError\",\n      value: function onError(event) {\n        if (event.code === 'ECONNREFUSED') {\n          this.reconnect();\n          return;\n        }\n\n        _get(_getPrototypeOf(WebsocketProvider.prototype), \"onError\", this).call(this, event);\n      }\n    }, {\n      key: \"onClose\",\n      value: function onClose(closeEvent) {\n        if (closeEvent.code !== 1000 || closeEvent.wasClean === false) {\n          this.reconnect();\n          return;\n        }\n\n        _get(_getPrototypeOf(WebsocketProvider.prototype), \"onClose\", this).call(this);\n      }\n    }, {\n      key: \"reconnect\",\n      value: function reconnect() {\n        var _this2 = this;\n\n        this.reconnecting = true;\n        setTimeout(function () {\n          _this2.removeAllSocketListeners();\n\n          var connection = [];\n\n          if (_this2.connection.constructor.name === 'W3CWebSocket') {\n            connection = new _this2.connection.constructor(_this2.host, _this2.connection._client.protocol, null, _this2.connection._client.headers, _this2.connection._client.requestOptions, _this2.connection._client.config);\n          } else {\n            connection = new _this2.connection.constructor(_this2.host, _this2.connection.protocol || undefined);\n          }\n\n          _this2.connection = connection;\n\n          _this2.registerEventListeners();\n        }, this.reconnectDelay);\n      }\n    }, {\n      key: \"disconnect\",\n      value: function disconnect() {\n        var code = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n        var reason = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n        this.connection.close(code, reason);\n      }\n    }, {\n      key: \"registerEventListeners\",\n      value: function registerEventListeners() {\n        this.connection.addEventListener('message', this.onMessage.bind(this));\n        this.connection.addEventListener('open', this.onReady.bind(this));\n        this.connection.addEventListener('open', this.onConnect.bind(this));\n        this.connection.addEventListener('close', this.onClose.bind(this));\n        this.connection.addEventListener('error', this.onError.bind(this));\n      }\n    }, {\n      key: \"removeAllListeners\",\n      value: function removeAllListeners(event) {\n        switch (event) {\n          case this.SOCKET_MESSAGE:\n            this.connection.removeEventListener('message', this.onMessage);\n            break;\n\n          case this.SOCKET_READY:\n            this.connection.removeEventListener('open', this.onReady);\n            break;\n\n          case this.SOCKET_CLOSE:\n            this.connection.removeEventListener('close', this.onClose);\n            break;\n\n          case this.SOCKET_ERROR:\n            this.connection.removeEventListener('error', this.onError);\n            break;\n\n          case this.SOCKET_CONNECT:\n            this.connection.removeEventListener('connect', this.onConnect);\n            break;\n        }\n\n        _get(_getPrototypeOf(WebsocketProvider.prototype), \"removeAllListeners\", this).call(this, event);\n      }\n    }, {\n      key: \"isConnecting\",\n      value: function isConnecting() {\n        return this.connection.readyState === this.connection.CONNECTING;\n      }\n    }, {\n      key: \"sendPayload\",\n      value: function sendPayload(payload) {\n        var _this3 = this;\n\n        return new Promise(function (resolve, reject) {\n          _this3.once('error', reject);\n\n          if (!_this3.isConnecting()) {\n            var timeout, id;\n\n            if (_this3.connection.readyState !== _this3.connection.OPEN) {\n              _this3.removeListener('error', reject);\n\n              return reject(new Error('Connection error: Connection is not open on send()'));\n            }\n\n            try {\n              _this3.connection.send(JSON.stringify(payload));\n            } catch (error) {\n              _this3.removeListener('error', reject);\n\n              return reject(error);\n            }\n\n            if (isArray(payload)) {\n              id = payload[0].id;\n            } else {\n              id = payload.id;\n            }\n\n            if (_this3.timeout) {\n              timeout = setTimeout(function () {\n                _this3.removeListener('error', reject);\n\n                _this3.removeAllListeners(id);\n\n                reject(new Error('Connection error: Timeout exceeded'));\n              }, _this3.timeout);\n            }\n\n            _this3.once(id, function (response) {\n              if (timeout) {\n                clearTimeout(timeout);\n              }\n\n              _this3.removeListener('error', reject);\n\n              return resolve(response);\n            });\n\n            return;\n          }\n\n          _this3.once('connect', function () {\n            _this3.sendPayload(payload).then(function (response) {\n              _this3.removeListener('error', reject);\n\n              return resolve(response);\n            }).catch(function (error) {\n              _this3.removeListener('error', reject);\n\n              return reject(error);\n            });\n          });\n        });\n      }\n    }, {\n      key: \"connected\",\n      get: function get() {\n        return this.connection.readyState === this.connection.OPEN;\n      }\n    }]);\n\n    return WebsocketProvider;\n  }(AbstractSocketProvider);\n\n  var IpcProvider = function (_AbstractSocketProvid) {\n    _inherits(IpcProvider, _AbstractSocketProvid);\n\n    function IpcProvider(connection, path) {\n      var _this;\n\n      _classCallCheck(this, IpcProvider);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(IpcProvider).call(this, connection, null));\n      _this.host = path;\n      _this.lastChunk = '';\n      return _this;\n    }\n\n    _createClass(IpcProvider, [{\n      key: \"disconnect\",\n      value: function disconnect() {\n        this.connection.destroy();\n      }\n    }, {\n      key: \"reconnect\",\n      value: function reconnect() {\n        this.connection.connect({\n          path: this.path\n        });\n      }\n    }, {\n      key: \"onMessage\",\n      value: function onMessage(message) {\n        var _this2 = this;\n\n        var result = null;\n        var returnValues = [];\n        var dechunkedData = message.toString().replace(/\\}[\\n\\r]?\\{/g, '}|--|{').replace(/\\}\\][\\n\\r]?\\[\\{/g, '}]|--|[{').replace(/\\}[\\n\\r]?\\[\\{/g, '}|--|[{').replace(/\\}\\][\\n\\r]?\\{/g, '}]|--|{').split('|--|');\n        dechunkedData.forEach(function (data) {\n          result = null;\n\n          if (_this2.lastChunk) {\n            data = _this2.lastChunk + data;\n          }\n\n          try {\n            result = JSON.parse(data);\n          } catch (error) {\n            _this2.lastChunk = data;\n            return;\n          }\n\n          _this2.lastChunk = null;\n          returnValues.push(result);\n        });\n        returnValues.forEach(function (chunk) {\n          _get(_getPrototypeOf(IpcProvider.prototype), \"onMessage\", _this2).call(_this2, chunk);\n        });\n      }\n    }, {\n      key: \"registerEventListeners\",\n      value: function registerEventListeners() {\n        this.connection.on('data', this.onMessage.bind(this));\n        this.connection.on('connect', this.onConnect.bind(this));\n        this.connection.on('error', this.onError.bind(this));\n        this.connection.on('close', this.onClose.bind(this));\n        this.connection.on('timeout', this.onClose.bind(this));\n        this.connection.on('ready', this.onReady.bind(this));\n      }\n    }, {\n      key: \"removeAllListeners\",\n      value: function removeAllListeners(event) {\n        switch (event) {\n          case this.SOCKET_MESSAGE:\n            this.connection.removeListener('data', this.onMessage);\n            break;\n\n          case this.SOCKET_READY:\n            this.connection.removeListener('ready', this.onReady);\n            break;\n\n          case this.SOCKET_CLOSE:\n            this.connection.removeListener('close', this.onClose);\n            break;\n\n          case this.SOCKET_ERROR:\n            this.connection.removeListener('error', this.onError);\n            break;\n\n          case this.SOCKET_CONNECT:\n            this.connection.removeListener('connect', this.onConnect);\n            break;\n        }\n\n        _get(_getPrototypeOf(IpcProvider.prototype), \"removeAllListeners\", this).call(this, event);\n      }\n    }, {\n      key: \"sendPayload\",\n      value: function sendPayload(payload) {\n        var _this3 = this;\n\n        return new Promise(function (resolve, reject) {\n          _this3.once('error', reject);\n\n          if (!_this3.connection.writable) {\n            _this3.connection.connect({\n              path: _this3.path\n            });\n          }\n\n          if (_this3.connection.write(JSON.stringify(payload))) {\n            var id;\n\n            if (isArray(payload)) {\n              id = payload[0].id;\n            } else {\n              id = payload.id;\n            }\n\n            _this3.once(id, function (response) {\n              resolve(response);\n\n              _this3.removeListener('error', reject);\n            });\n\n            return;\n          }\n\n          _this3.removeListener('error', reject);\n\n          return reject(new Error(\"Connection error: Couldn't write on the socket with Socket.write(payload)\"));\n        });\n      }\n    }, {\n      key: \"connected\",\n      get: function get() {\n        return !this.connection.pending;\n      }\n    }]);\n\n    return IpcProvider;\n  }(AbstractSocketProvider);\n\n  var HttpProvider = function () {\n    function HttpProvider() {\n      var host = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'http://localhost:8545';\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var providersModuleFactory = arguments.length > 2 ? arguments[2] : undefined;\n\n      _classCallCheck(this, HttpProvider);\n\n      this.host = host;\n      this.timeout = options.timeout || 0;\n      this.headers = options.headers;\n      this.withCredentials = options.withCredentials || false;\n      this.connected = true;\n      this.providersModuleFactory = providersModuleFactory;\n      this.agent = {};\n      var keepAlive = false;\n\n      if (options.keepAlive === true || options.keepAlive !== false) {\n        keepAlive = true;\n      }\n\n      if (host.substring(0, 5) === 'https') {\n        this.agent['httpsAgent'] = new https.Agent({\n          keepAlive: keepAlive\n        });\n      } else {\n        this.agent['httpAgent'] = new http.Agent({\n          keepAlive: keepAlive\n        });\n      }\n    }\n\n    _createClass(HttpProvider, [{\n      key: \"supportsSubscriptions\",\n      value: function supportsSubscriptions() {\n        return false;\n      }\n    }, {\n      key: \"subscribe\",\n      value: function subscribe() {\n        throw new Error('Subscriptions are not supported with the HttpProvider.');\n      }\n    }, {\n      key: \"unsubscribe\",\n      value: function unsubscribe() {\n        throw new Error('Subscriptions are not supported with the HttpProvider.');\n      }\n    }, {\n      key: \"disconnect\",\n      value: function disconnect() {\n        return true;\n      }\n    }, {\n      key: \"send\",\n      value: function () {\n        var _send = _asyncToGenerator(_regeneratorRuntime.mark(function _callee(method, parameters) {\n          var response, validationResult;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return this.sendPayload(JsonRpcMapper.toPayload(method, parameters));\n\n                case 2:\n                  response = _context.sent;\n                  validationResult = JsonRpcResponseValidator.validate(response);\n\n                  if (!(validationResult instanceof Error)) {\n                    _context.next = 6;\n                    break;\n                  }\n\n                  throw validationResult;\n\n                case 6:\n                  return _context.abrupt(\"return\", response.result);\n\n                case 7:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        function send(_x, _x2) {\n          return _send.apply(this, arguments);\n        }\n\n        return send;\n      }()\n    }, {\n      key: \"sendBatch\",\n      value: function sendBatch(methods, moduleInstance) {\n        var payload = [];\n        methods.forEach(function (method) {\n          method.beforeExecution(moduleInstance);\n          payload.push(JsonRpcMapper.toPayload(method.rpcMethod, method.parameters));\n        });\n        return this.sendPayload(payload);\n      }\n    }, {\n      key: \"sendPayload\",\n      value: function sendPayload(payload) {\n        var _this = this;\n\n        return new Promise(function (resolve, reject) {\n          var request = _this.providersModuleFactory.createXMLHttpRequest(_this.host, _this.timeout, _this.headers, _this.agent, _this.withCredentials);\n\n          request.onreadystatechange = function () {\n            if (request.readyState !== 0 && request.readyState !== 1) {\n              _this.connected = true;\n            }\n\n            if (request.readyState === 4) {\n              if (request.status === 200) {\n                try {\n                  return resolve(JSON.parse(request.responseText));\n                } catch (error) {\n                  reject(new Error(\"Invalid JSON as response: \".concat(request.responseText)));\n                }\n              }\n\n              if (_this.isInvalidHttpEndpoint(request)) {\n                reject(new Error(\"Connection refused or URL couldn't be resolved: \".concat(_this.host)));\n              }\n\n              if (request.status >= 400 && request.status <= 499) {\n                reject(new Error(\"HttpProvider ERROR: \".concat(request.responseText, \" (code: \").concat(request.status, \")\")));\n              }\n            }\n          };\n\n          request.ontimeout = function () {\n            _this.connected = false;\n            reject(new Error(\"Connection error: Timeout exceeded after \".concat(_this.timeout, \"ms\")));\n          };\n\n          try {\n            request.send(JSON.stringify(payload));\n          } catch (error) {\n            _this.connected = false;\n            reject(error);\n          }\n        });\n      }\n    }, {\n      key: \"isInvalidHttpEndpoint\",\n      value: function isInvalidHttpEndpoint(request) {\n        return request.response === null && request.status === 0;\n      }\n    }]);\n\n    return HttpProvider;\n  }();\n\n  var BatchRequest = function () {\n    function BatchRequest(moduleInstance) {\n      _classCallCheck(this, BatchRequest);\n\n      this.moduleInstance = moduleInstance;\n      this.methods = [];\n      this.accounts = [];\n    }\n\n    _createClass(BatchRequest, [{\n      key: \"add\",\n      value: function add(method) {\n        if (!isObject(method) && method) {\n          throw new Error('Please provide a object of type AbstractMethod.');\n        }\n\n        this.methods.push(method);\n      }\n    }, {\n      key: \"execute\",\n      value: function () {\n        var _execute = _asyncToGenerator(_regeneratorRuntime.mark(function _callee() {\n          var _this = this;\n\n          var payload, response, hasCallbacks, errors;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return this.toPayload();\n\n                case 2:\n                  payload = _context.sent;\n                  _context.next = 5;\n                  return this.moduleInstance.currentProvider.sendPayload(payload);\n\n                case 5:\n                  response = _context.sent;\n                  hasCallbacks = false;\n                  errors = [];\n                  this.methods.forEach(function (method, index) {\n                    if (!hasCallbacks && method.callback) {\n                      hasCallbacks = true;\n                    }\n\n                    if (!isArray(response)) {\n                      if (method.callback) {\n                        method.callback(new Error(\"BatchRequest error: Response should be of type Array but is: \".concat(_typeof(response))), null);\n                        return;\n                      }\n\n                      throw new Error(\"BatchRequest error: Response should be of type Array but is: \".concat(_typeof(response)));\n                    }\n\n                    var responseItem = response[index] || null;\n                    var validationResult = JsonRpcResponseValidator.validate(responseItem);\n\n                    if (validationResult === true) {\n                      try {\n                        var mappedResult;\n\n                        if (method.Type === 'eth-send-transaction-method' || method.Type === 'observed-transaction-method') {\n                          mappedResult = responseItem.result;\n                        } else {\n                          mappedResult = method.afterExecution(responseItem.result);\n                        }\n\n                        response[index] = mappedResult;\n\n                        if (method.callback) {\n                          method.callback(false, mappedResult);\n                        }\n                      } catch (error) {\n                        errors[index] = {\n                          method: method,\n                          error: error\n                        };\n\n                        if (method.callback) {\n                          method.callback(error, null);\n                        }\n                      }\n\n                      return;\n                    }\n\n                    errors[index] = {\n                      method: method,\n                      error: validationResult\n                    };\n\n                    if (_this.accounts[index] && _this.accounts[index].nonce) {\n                      _this.accounts[index].nonce--;\n                    }\n\n                    if (method.callback) {\n                      method.callback(validationResult, null);\n                    }\n                  });\n\n                  if (!(errors.length > 0 && !hasCallbacks)) {\n                    _context.next = 11;\n                    break;\n                  }\n\n                  throw {\n                    errors: errors,\n                    response: response\n                  };\n\n                case 11:\n                  return _context.abrupt(\"return\", {\n                    methods: this.methods,\n                    response: response\n                  });\n\n                case 12:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        function execute() {\n          return _execute.apply(this, arguments);\n        }\n\n        return execute;\n      }()\n    }, {\n      key: \"toPayload\",\n      value: function () {\n        var _toPayload = _asyncToGenerator(_regeneratorRuntime.mark(function _callee2() {\n          var payload, i, method, account, response;\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  payload = [];\n                  i = 0;\n\n                case 2:\n                  if (!(i < this.methods.length)) {\n                    _context2.next = 18;\n                    break;\n                  }\n\n                  method = this.methods[i];\n                  method.beforeExecution(this.moduleInstance);\n\n                  if (!(this.moduleInstance.accounts && method.Type === 'eth-send-transaction-method' && method.hasAccounts())) {\n                    _context2.next = 14;\n                    break;\n                  }\n\n                  account = this.moduleInstance.accounts.wallet[method.parameters[0].from];\n\n                  if (!account) {\n                    _context2.next = 14;\n                    break;\n                  }\n\n                  _context2.next = 10;\n                  return method.signTransaction(account);\n\n                case 10:\n                  response = _context2.sent;\n                  method.parameters = [response.rawTransaction];\n                  method.rpcMethod = 'eth_sendRawTransaction';\n                  this.accounts[i] = account;\n\n                case 14:\n                  payload.push(JsonRpcMapper.toPayload(method.rpcMethod, method.parameters));\n\n                case 15:\n                  i++;\n                  _context2.next = 2;\n                  break;\n\n                case 18:\n                  return _context2.abrupt(\"return\", payload);\n\n                case 19:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this);\n        }));\n\n        function toPayload() {\n          return _toPayload.apply(this, arguments);\n        }\n\n        return toPayload;\n      }()\n    }]);\n\n    return BatchRequest;\n  }();\n\n  var Web3EthereumProvider = function (_AbstractSocketProvid) {\n    _inherits(Web3EthereumProvider, _AbstractSocketProvid);\n\n    function Web3EthereumProvider(connection) {\n      var _this;\n\n      _classCallCheck(this, Web3EthereumProvider);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(Web3EthereumProvider).call(this, connection, null));\n      _this.host = 'Web3EthereumProvider';\n      return _this;\n    }\n\n    _createClass(Web3EthereumProvider, [{\n      key: \"registerEventListeners\",\n      value: function registerEventListeners() {\n        this.connection.on('notification', this.onMessage.bind(this));\n        this.connection.on('connect', this.onConnect.bind(this));\n        this.connection.on('connect', this.onReady.bind(this));\n        this.connection.on('close', this.onClose.bind(this));\n        this.connection.on('networkChanged', this.onNetworkChanged.bind(this));\n        this.connection.on('accountsChanged', this.onAccountsChanged.bind(this));\n      }\n    }, {\n      key: \"removeAllListeners\",\n      value: function removeAllListeners(event) {\n        switch (event) {\n          case this.SOCKET_NETWORK_CHANGED:\n            this.connection.removeListener('networkChanged', this.onNetworkChanged);\n            break;\n\n          case this.SOCKET_ACCOUNTS_CHANGED:\n            this.connection.removeListener('accountsChanged', this.onAccountsChanged);\n            break;\n\n          case this.SOCKET_MESSAGE:\n            this.connection.removeListener('notification', this.onMessage);\n            break;\n\n          case this.SOCKET_READY:\n            this.connection.removeListener('connect', this.onReady);\n            break;\n\n          case this.SOCKET_CLOSE:\n            this.connection.removeListener('close', this.onClose);\n            break;\n\n          case this.SOCKET_ERROR:\n            this.connection.removeListener('close', this.onError);\n            break;\n\n          case this.SOCKET_CONNECT:\n            this.connection.removeListener('connect', this.onConnect);\n            break;\n        }\n\n        _get(_getPrototypeOf(Web3EthereumProvider.prototype), \"removeAllListeners\", this).call(this, event);\n      }\n    }, {\n      key: \"removeAllSocketListeners\",\n      value: function removeAllSocketListeners() {\n        this.removeAllListeners(this.SOCKET_ACCOUNTS_CHANGED);\n        this.removeAllListeners(this.SOCKET_NETWORK_CHANGED);\n\n        _get(_getPrototypeOf(Web3EthereumProvider.prototype), \"removeAllSocketListeners\", this).call(this);\n      }\n    }, {\n      key: \"onNetworkChanged\",\n      value: function onNetworkChanged(networkId) {\n        this.emit('networkChanged', networkId);\n      }\n    }, {\n      key: \"onAccountsChanged\",\n      value: function onAccountsChanged(accounts) {\n        this.emit('accountsChanged', accounts);\n      }\n    }, {\n      key: \"onMessage\",\n      value: function onMessage(response) {\n        this.emit(this.getSubscriptionEvent(response.subscription), response);\n      }\n    }, {\n      key: \"send\",\n      value: function () {\n        var _send = _asyncToGenerator(_regeneratorRuntime.mark(function _callee(method, parameters) {\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.prev = 0;\n                  _context.next = 3;\n                  return this.connection.send(method, parameters);\n\n                case 3:\n                  return _context.abrupt(\"return\", _context.sent);\n\n                case 6:\n                  _context.prev = 6;\n                  _context.t0 = _context[\"catch\"](0);\n                  throw new Error(\"Node error: \".concat(_context.t0.message));\n\n                case 9:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this, [[0, 6]]);\n        }));\n\n        function send(_x, _x2) {\n          return _send.apply(this, arguments);\n        }\n\n        return send;\n      }()\n    }, {\n      key: \"sendBatch\",\n      value: function sendBatch(methods, moduleInstance) {\n        var _this2 = this;\n\n        var methodCalls = [];\n        methods.forEach(function (method) {\n          method.beforeExecution(moduleInstance);\n          methodCalls.push(_this2.connection.send(method.rpcMethod, method.parameters));\n        });\n        return Promise.all(methodCalls);\n      }\n    }]);\n\n    return Web3EthereumProvider;\n  }(AbstractSocketProvider);\n\n  var MetamaskProvider = function (_AbstractSocketProvid) {\n    _inherits(MetamaskProvider, _AbstractSocketProvid);\n\n    function MetamaskProvider(inpageProvider) {\n      var _this;\n\n      _classCallCheck(this, MetamaskProvider);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(MetamaskProvider).call(this, inpageProvider, null));\n      _this.host = 'metamask';\n      return _this;\n    }\n\n    _createClass(MetamaskProvider, [{\n      key: \"registerEventListeners\",\n      value: function registerEventListeners() {\n        this.connection.on('accountsChanged', this.onAccountsChanged.bind(this));\n        this.connection.on('networkChanged', this.onReady.bind(this));\n        this.connection.on('networkChanged', this.onNetworkChanged.bind(this));\n        this.connection.on('data', this.onMessage.bind(this));\n        this.connection.on('error', this.onError.bind(this));\n      }\n    }, {\n      key: \"onMessage\",\n      value: function onMessage(metamaskParam, payload) {\n        _get(_getPrototypeOf(MetamaskProvider.prototype), \"onMessage\", this).call(this, payload);\n      }\n    }, {\n      key: \"removeAllListeners\",\n      value: function removeAllListeners(event) {\n        switch (event) {\n          case this.SOCKET_NETWORK_CHANGED:\n            this.connection.removeListener('networkChanged', this.onNetworkChanged);\n            break;\n\n          case this.SOCKET_ACCOUNTS_CHANGED:\n            this.connection.removeListener('accountsChanged', this.onAccountsChanged);\n            break;\n\n          case this.SOCKET_MESSAGE:\n            this.connection.removeListener('data', this.onMessage);\n            break;\n\n          case this.SOCKET_ERROR:\n            this.connection.removeListener('error', this.onError);\n            break;\n        }\n\n        _get(_getPrototypeOf(MetamaskProvider.prototype), \"removeAllListeners\", this).call(this, event);\n      }\n    }, {\n      key: \"removeAllSocketListeners\",\n      value: function removeAllSocketListeners() {\n        this.removeAllListeners(this.SOCKET_ACCOUNTS_CHANGED);\n        this.removeAllListeners(this.SOCKET_NETWORK_CHANGED);\n\n        _get(_getPrototypeOf(MetamaskProvider.prototype), \"removeAllSocketListeners\", this).call(this);\n      }\n    }, {\n      key: \"onNetworkChanged\",\n      value: function onNetworkChanged(networkId) {\n        this.emit('networkChanged', networkId);\n      }\n    }, {\n      key: \"onAccountsChanged\",\n      value: function onAccountsChanged(accounts) {\n        this.emit('accountsChanged', accounts);\n      }\n    }, {\n      key: \"disconnect\",\n      value: function disconnect() {\n        return true;\n      }\n    }, {\n      key: \"sendPayload\",\n      value: function sendPayload(payload) {\n        var _this2 = this;\n\n        return new Promise(function (resolve, reject) {\n          _this2.connection.send(payload, function (error, response) {\n            if (!error) {\n              return resolve(response);\n            }\n\n            reject(error);\n          });\n        });\n      }\n    }, {\n      key: \"connected\",\n      get: function get() {\n        return this.connection.isConnected();\n      }\n    }]);\n\n    return MetamaskProvider;\n  }(AbstractSocketProvider);\n\n  var MistEthereumProvider = function (_AbstractSocketProvid) {\n    _inherits(MistEthereumProvider, _AbstractSocketProvid);\n\n    function MistEthereumProvider(connection) {\n      var _this;\n\n      _classCallCheck(this, MistEthereumProvider);\n\n      _this = _possibleConstructorReturn(this, _getPrototypeOf(MistEthereumProvider).call(this, connection, null));\n      _this.host = 'mist';\n      return _this;\n    }\n\n    _createClass(MistEthereumProvider, [{\n      key: \"registerEventListeners\",\n      value: function registerEventListeners() {\n        this.connection.on('data', this.onMessage.bind(this));\n        this.connection.on('error', this.onError.bind(this));\n        this.connection.on('connect', this.onConnect.bind(this));\n        this.connection.on('connect', this.onReady.bind(this));\n        this.connection.on('end', this.onClose.bind(this));\n      }\n    }, {\n      key: \"removeAllListeners\",\n      value: function removeAllListeners(event) {\n        switch (event) {\n          case this.SOCKET_MESSAGE:\n            this.connection.removeListener('data', this.onMessage);\n            break;\n\n          case this.SOCKET_ERROR:\n            this.connection.removeListener('error', this.onError);\n            break;\n\n          case this.SOCKET_CONNECT:\n            this.connection.removeListener('connect', this.onConnect);\n            break;\n\n          case this.SOCKET_READY:\n            this.connection.removeListener('connect', this.onConnect);\n            break;\n\n          case this.SOCKET_CLOSE:\n            this.connection.removeListener('end', this.onClose);\n            break;\n        }\n\n        _get(_getPrototypeOf(MistEthereumProvider.prototype), \"removeAllListeners\", this).call(this, event);\n      }\n    }, {\n      key: \"disconnect\",\n      value: function disconnect() {\n        return true;\n      }\n    }, {\n      key: \"sendPayload\",\n      value: function sendPayload(payload) {\n        var _this2 = this;\n\n        return new Promise(function (resolve, reject) {\n          _this2.connection.send(payload, function (error, response) {\n            if (!error) {\n              return resolve(response);\n            }\n\n            reject(error);\n          });\n        });\n      }\n    }, {\n      key: \"connected\",\n      get: function get() {\n        return this.connection.isConnected();\n      }\n    }]);\n\n    return MistEthereumProvider;\n  }(AbstractSocketProvider);\n\n  var CustomProvider = function () {\n    function CustomProvider(connection) {\n      _classCallCheck(this, CustomProvider);\n\n      this.host = 'CustomProvider';\n      this.connection = connection;\n      this.checkConnectionMethods();\n    }\n\n    _createClass(CustomProvider, [{\n      key: \"supportsSubscriptions\",\n      value: function supportsSubscriptions() {\n        return false;\n      }\n    }, {\n      key: \"checkConnectionMethods\",\n      value: function checkConnectionMethods() {\n        if (this.connection.send || this.connection.sendAsync) {\n          return true;\n        }\n\n        throw new Error('Invalid provider injected!');\n      }\n    }, {\n      key: \"subscribe\",\n      value: function subscribe() {\n        throw new Error('Subscriptions are not supported with the CustomProvider.');\n      }\n    }, {\n      key: \"unsubscribe\",\n      value: function unsubscribe() {\n        throw new Error('Subscriptions are not supported with the CustomProvider.');\n      }\n    }, {\n      key: \"send\",\n      value: function () {\n        var _send = _asyncToGenerator(_regeneratorRuntime.mark(function _callee(method, parameters) {\n          var response, validationResult;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return this.sendPayload(JsonRpcMapper.toPayload(method, parameters));\n\n                case 2:\n                  response = _context.sent;\n                  validationResult = JsonRpcResponseValidator.validate(response);\n\n                  if (!(validationResult instanceof Error)) {\n                    _context.next = 6;\n                    break;\n                  }\n\n                  throw validationResult;\n\n                case 6:\n                  return _context.abrupt(\"return\", response.result);\n\n                case 7:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        function send(_x, _x2) {\n          return _send.apply(this, arguments);\n        }\n\n        return send;\n      }()\n    }, {\n      key: \"sendBatch\",\n      value: function sendBatch(methods, moduleInstance) {\n        var payload = [];\n        methods.forEach(function (method) {\n          method.beforeExecution(moduleInstance);\n          payload.push(JsonRpcMapper.toPayload(method.rpcMethod, method.parameters));\n        });\n        return this.sendPayload(payload);\n      }\n    }, {\n      key: \"sendPayload\",\n      value: function sendPayload(payload) {\n        var _this = this;\n\n        return new Promise(function (resolve, reject) {\n          if (_this.connection.sendAsync) {\n            _this.connection.sendAsync(payload, function (error, response) {\n              if (!error) {\n                resolve(response);\n              }\n\n              reject(error);\n            });\n\n            return;\n          }\n\n          _this.connection.send(payload, function (error, response) {\n            if (!error) {\n              resolve(response);\n            }\n\n            reject(error);\n          });\n        });\n      }\n    }]);\n\n    return CustomProvider;\n  }();\n\n  var ProvidersModuleFactory = function () {\n    function ProvidersModuleFactory() {\n      _classCallCheck(this, ProvidersModuleFactory);\n    }\n\n    _createClass(ProvidersModuleFactory, [{\n      key: \"createBatchRequest\",\n      value: function createBatchRequest(moduleInstance) {\n        return new BatchRequest(moduleInstance);\n      }\n    }, {\n      key: \"createProviderResolver\",\n      value: function createProviderResolver() {\n        return new ProviderResolver(this);\n      }\n    }, {\n      key: \"createHttpProvider\",\n      value: function createHttpProvider(url) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        return new HttpProvider(url, options, this);\n      }\n    }, {\n      key: \"createXMLHttpRequest\",\n      value: function createXMLHttpRequest(host, timeout, headers, agent, withCredentials) {\n        var request;\n\n        if (typeof process !== 'undefined' && process.versions != null && process.versions.node != null) {\n          request = new xhr2Cookies.XMLHttpRequest();\n          request.nodejsSet(agent);\n        } else {\n          request = new XMLHttpRequest();\n        }\n\n        request.open('POST', host, true);\n        request.setRequestHeader('Content-Type', 'application/json');\n        request.timeout = timeout;\n        request.withCredentials = withCredentials;\n\n        if (headers) {\n          headers.forEach(function (header) {\n            request.setRequestHeader(header.name, header.value);\n          });\n        }\n\n        return request;\n      }\n    }, {\n      key: \"createWebsocketProvider\",\n      value: function createWebsocketProvider(url) {\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var headers = options.headers || {};\n\n        if (typeof process !== 'undefined' && process.versions != null && process.versions.node != null) {\n          var urlObject = new URL(url);\n\n          if (!headers.authorization && urlObject.username && urlObject.password) {\n            var authToken = Buffer.from(\"\".concat(urlObject.username, \":\").concat(urlObject.password)).toString('base64');\n            headers.authorization = \"Basic \".concat(authToken);\n          }\n        }\n\n        return new WebsocketProvider(new websocket.w3cwebsocket(url, options.protocol, options.origin, headers, options.requestOptions, options.clientConfig), options.timeout, options.reconnectDelay);\n      }\n    }, {\n      key: \"createIpcProvider\",\n      value: function createIpcProvider(path, net) {\n        return new IpcProvider(net.connect({\n          path: path\n        }), path);\n      }\n    }, {\n      key: \"createWeb3EthereumProvider\",\n      value: function createWeb3EthereumProvider(connection) {\n        return new Web3EthereumProvider(connection);\n      }\n    }, {\n      key: \"createMetamaskProvider\",\n      value: function createMetamaskProvider(inpageProvider) {\n        return new MetamaskProvider(inpageProvider);\n      }\n    }, {\n      key: \"createMistEthereumProvider\",\n      value: function createMistEthereumProvider(mistEthereumProvider) {\n        return new MistEthereumProvider(mistEthereumProvider);\n      }\n    }, {\n      key: \"createCustomProvider\",\n      value: function createCustomProvider(connection) {\n        return new CustomProvider(connection);\n      }\n    }]);\n\n    return ProvidersModuleFactory;\n  }();\n\n  var global$1 = function () {\n    return this || (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' && self;\n  }() || new Function('return this')();\n\n  var ProviderDetector = function () {\n    function ProviderDetector() {\n      _classCallCheck(this, ProviderDetector);\n    }\n\n    _createClass(ProviderDetector, null, [{\n      key: \"detect\",\n      value: function detect() {\n        if (typeof global$1.ethereumProvider !== 'undefined' && global$1.ethereumProvider.constructor.name === 'EthereumProvider') {\n          return global$1.ethereumProvider;\n        }\n\n        if (typeof global$1.web3 !== 'undefined' && global$1.web3.currentProvider) {\n          return global$1.web3.currentProvider;\n        }\n\n        return null;\n      }\n    }]);\n\n    return ProviderDetector;\n  }();\n\n  function HttpProvider$1(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return new ProvidersModuleFactory().createHttpProvider(url, options);\n  }\n\n  function WebsocketProvider$1(url) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return new ProvidersModuleFactory().createWebsocketProvider(url, options);\n  }\n\n  function IpcProvider$1(path, net) {\n    return new ProvidersModuleFactory().createIpcProvider(path, net);\n  }\n\n  function BatchRequest$1(moduleInstance) {\n    return new ProvidersModuleFactory().createBatchRequest(moduleInstance);\n  }\n\n  function ProviderResolver$1() {\n    return new ProvidersModuleFactory().createProviderResolver();\n  }\n\n  exports.BatchRequest = BatchRequest$1;\n  exports.HttpProvider = HttpProvider$1;\n  exports.IpcProvider = IpcProvider$1;\n  exports.ProviderDetector = ProviderDetector;\n  exports.ProviderResolver = ProviderResolver$1;\n  exports.ProvidersModuleFactory = ProvidersModuleFactory;\n  exports.Web3EthereumProvider = Web3EthereumProvider;\n  exports.WebsocketProvider = WebsocketProvider$1;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"sources":["/home/ryan/dev/defi/shadowtoken2/node_modules/web3-providers/dist/web3-providers.umd.js"],"names":["global","factory","exports","module","require","define","amd","self","Web3Providers","_classCallCheck","_createClass","websocket","xhr2Cookies","URL","_typeof","isFunction","isObject","_regeneratorRuntime","_asyncToGenerator","_possibleConstructorReturn","_getPrototypeOf","_get","_inherits","EventEmitter","isArray","http","https","hasOwnProperty","Function","ProviderResolver","providersModuleFactory","key","value","resolve","provider","net","test","createHttpProvider","createWebsocketProvider","connect","createIpcProvider","sendPayload","subscribe","host","mist","constructor","name","createMistEthereumProvider","isEIP1193","createWeb3EthereumProvider","isMetamaskInpageProvider","createMetamaskProvider","createCustomProvider","messageId","JsonRpcMapper","toPayload","method","params","Error","concat","JSON","stringify","id","jsonrpc","JsonRpcResponseValidator","validate","response","payload","arguments","length","undefined","error","message","result","AbstractSocketProvider","_EventEmitter","connection","timeout","_this","call","subscriptions","Map","registerEventListeners","READY","CONNECT","ERROR","CLOSE","SOCKET_MESSAGE","SOCKET_READY","SOCKET_CLOSE","SOCKET_ERROR","SOCKET_CONNECT","SOCKET_NETWORK_CHANGED","SOCKET_ACCOUNTS_CHANGED","supportsSubscriptions","removeAllSocketListeners","removeAllListeners","disconnect","code","reason","_send","mark","_callee","parameters","validationResult","wrap","_callee$","_context","prev","next","sent","abrupt","stop","send","_x","_x2","apply","sendBatch","methods","moduleInstance","forEach","beforeExecution","push","rpcMethod","onReady","event","emit","onError","onClose","_onConnect","_callee2","subscriptionId","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","item","_callee2$","_context2","size","Symbol","iterator","done","subscribeMethod","slice","delete","t0","return","finish","onConnect","onMessage","parse","getSubscriptionEvent","subscription","reset","subscriptionMethod","_this2","unshift","then","set","catch","unsubscribe","unsubscribeMethod","_this3","hasSubscription","Promise","reject","clearSubscriptions","_this4","unsubscribePromises","type","all","results","includes","get","WebsocketProvider","_AbstractSocketProvid","reconnectDelay","url","reconnecting","prototype","messageEvent","data","reconnect","closeEvent","wasClean","setTimeout","_client","protocol","headers","requestOptions","config","close","addEventListener","bind","removeEventListener","isConnecting","readyState","CONNECTING","once","OPEN","removeListener","clearTimeout","IpcProvider","path","lastChunk","destroy","returnValues","dechunkedData","toString","replace","split","chunk","on","writable","write","pending","HttpProvider","options","withCredentials","connected","agent","keepAlive","substring","Agent","request","createXMLHttpRequest","onreadystatechange","status","responseText","isInvalidHttpEndpoint","ontimeout","BatchRequest","accounts","add","_execute","hasCallbacks","errors","currentProvider","index","callback","responseItem","mappedResult","Type","afterExecution","nonce","execute","_toPayload","i","account","hasAccounts","wallet","from","signTransaction","rawTransaction","Web3EthereumProvider","onNetworkChanged","onAccountsChanged","networkId","methodCalls","MetamaskProvider","inpageProvider","metamaskParam","isConnected","MistEthereumProvider","CustomProvider","checkConnectionMethods","sendAsync","ProvidersModuleFactory","createBatchRequest","createProviderResolver","process","versions","node","XMLHttpRequest","nodejsSet","open","setRequestHeader","header","urlObject","authorization","username","password","authToken","Buffer","w3cwebsocket","origin","clientConfig","mistEthereumProvider","global$1","ProviderDetector","detect","ethereumProvider","web3","HttpProvider$1","WebsocketProvider$1","IpcProvider$1","BatchRequest$1","ProviderResolver$1","Object","defineProperty"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@babel/runtime/helpers/classCallCheck'), require('@babel/runtime/helpers/createClass'), require('websocket'), require('xhr2-cookies'), require('url-parse'), require('@babel/runtime/helpers/typeof'), require('lodash/isFunction'), require('lodash/isObject'), require('@babel/runtime/regenerator'), require('@babel/runtime/helpers/asyncToGenerator'), require('@babel/runtime/helpers/possibleConstructorReturn'), require('@babel/runtime/helpers/getPrototypeOf'), require('@babel/runtime/helpers/get'), require('@babel/runtime/helpers/inherits'), require('eventemitter3'), require('lodash/isArray'), require('http'), require('https')) :\n    typeof define === 'function' && define.amd ? define(['exports', '@babel/runtime/helpers/classCallCheck', '@babel/runtime/helpers/createClass', 'websocket', 'xhr2-cookies', 'url-parse', '@babel/runtime/helpers/typeof', 'lodash/isFunction', 'lodash/isObject', '@babel/runtime/regenerator', '@babel/runtime/helpers/asyncToGenerator', '@babel/runtime/helpers/possibleConstructorReturn', '@babel/runtime/helpers/getPrototypeOf', '@babel/runtime/helpers/get', '@babel/runtime/helpers/inherits', 'eventemitter3', 'lodash/isArray', 'http', 'https'], factory) :\n    (global = global || self, factory(global.Web3Providers = {}, global._classCallCheck, global._createClass, global.websocket, global.xhr2Cookies, global.URL, global._typeof, global.isFunction, global.isObject, global._regeneratorRuntime, global._asyncToGenerator, global._possibleConstructorReturn, global._getPrototypeOf, global._get, global._inherits, global.EventEmitter, global.isArray, global.http, global.https));\n}(this, function (exports, _classCallCheck, _createClass, websocket, xhr2Cookies, URL, _typeof, isFunction, isObject, _regeneratorRuntime, _asyncToGenerator, _possibleConstructorReturn, _getPrototypeOf, _get, _inherits, EventEmitter, isArray, http, https) { 'use strict';\n\n    _classCallCheck = _classCallCheck && _classCallCheck.hasOwnProperty('default') ? _classCallCheck['default'] : _classCallCheck;\n    _createClass = _createClass && _createClass.hasOwnProperty('default') ? _createClass['default'] : _createClass;\n    URL = URL && URL.hasOwnProperty('default') ? URL['default'] : URL;\n    _typeof = _typeof && _typeof.hasOwnProperty('default') ? _typeof['default'] : _typeof;\n    isFunction = isFunction && isFunction.hasOwnProperty('default') ? isFunction['default'] : isFunction;\n    isObject = isObject && isObject.hasOwnProperty('default') ? isObject['default'] : isObject;\n    _regeneratorRuntime = _regeneratorRuntime && _regeneratorRuntime.hasOwnProperty('default') ? _regeneratorRuntime['default'] : _regeneratorRuntime;\n    _asyncToGenerator = _asyncToGenerator && _asyncToGenerator.hasOwnProperty('default') ? _asyncToGenerator['default'] : _asyncToGenerator;\n    _possibleConstructorReturn = _possibleConstructorReturn && _possibleConstructorReturn.hasOwnProperty('default') ? _possibleConstructorReturn['default'] : _possibleConstructorReturn;\n    _getPrototypeOf = _getPrototypeOf && _getPrototypeOf.hasOwnProperty('default') ? _getPrototypeOf['default'] : _getPrototypeOf;\n    _get = _get && _get.hasOwnProperty('default') ? _get['default'] : _get;\n    _inherits = _inherits && _inherits.hasOwnProperty('default') ? _inherits['default'] : _inherits;\n    EventEmitter = EventEmitter && EventEmitter.hasOwnProperty('default') ? EventEmitter['default'] : EventEmitter;\n    isArray = isArray && isArray.hasOwnProperty('default') ? isArray['default'] : isArray;\n    http = http && http.hasOwnProperty('default') ? http['default'] : http;\n    https = https && https.hasOwnProperty('default') ? https['default'] : https;\n\n    var global = function () {\n      return this || (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' && self;\n    }() || new Function('return this')();\n    var ProviderResolver =\n    function () {\n      function ProviderResolver(providersModuleFactory) {\n        _classCallCheck(this, ProviderResolver);\n        this.providersModuleFactory = providersModuleFactory;\n      }\n      _createClass(ProviderResolver, [{\n        key: \"resolve\",\n        value: function resolve(provider, net) {\n          if (!provider) {\n            return provider;\n          }\n          if (typeof provider === 'string') {\n            if (/^http(s)?:\\/\\//i.test(provider)) {\n              return this.providersModuleFactory.createHttpProvider(provider);\n            }\n            if (/^ws(s)?:\\/\\//i.test(provider)) {\n              return this.providersModuleFactory.createWebsocketProvider(provider);\n            }\n            if (provider && isObject(net) && isFunction(net.connect)) {\n              return this.providersModuleFactory.createIpcProvider(provider, net);\n            }\n          }\n          if (provider.sendPayload && provider.subscribe) {\n            return provider;\n          }\n          if (provider.host === 'Web3EthereumProvider') {\n            return provider;\n          }\n          if (typeof global.mist !== 'undefined' && provider.constructor.name === 'EthereumProvider') {\n            return this.providersModuleFactory.createMistEthereumProvider(provider);\n          }\n          if (provider.isEIP1193) {\n            return this.providersModuleFactory.createWeb3EthereumProvider(provider);\n          }\n          if (this.isMetamaskInpageProvider(provider)) {\n            return this.providersModuleFactory.createMetamaskProvider(provider);\n          }\n          return this.providersModuleFactory.createCustomProvider(provider);\n        }\n      }, {\n        key: \"isMetamaskInpageProvider\",\n        value: function isMetamaskInpageProvider(provider) {\n          return provider.constructor.name === 'MetamaskInpageProvider';\n        }\n      }]);\n      return ProviderResolver;\n    }();\n\n    var messageId = 0;\n    var JsonRpcMapper =\n    function () {\n      function JsonRpcMapper() {\n        _classCallCheck(this, JsonRpcMapper);\n      }\n      _createClass(JsonRpcMapper, null, [{\n        key: \"toPayload\",\n        value: function toPayload(method, params) {\n          if (!method) {\n            throw new Error(\"JSONRPC method should be specified for params: \\\"\".concat(JSON.stringify(params), \"\\\"!\"));\n          }\n          var id = messageId;\n          messageId++;\n          return {\n            jsonrpc: '2.0',\n            id: id,\n            method: method,\n            params: params || []\n          };\n        }\n      }]);\n      return JsonRpcMapper;\n    }();\n\n    var JsonRpcResponseValidator =\n    function () {\n      function JsonRpcResponseValidator() {\n        _classCallCheck(this, JsonRpcResponseValidator);\n      }\n      _createClass(JsonRpcResponseValidator, null, [{\n        key: \"validate\",\n        value: function validate(response) {\n          var payload = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n          if (isObject(response)) {\n            if (response.error) {\n              if (response.error instanceof Error) {\n                return new Error(\"Node error: \".concat(response.error.message));\n              }\n              return new Error(\"Node error: \".concat(JSON.stringify(response.error)));\n            }\n            if (payload && response.id !== payload.id) {\n              return new Error(\"Validation error: Invalid JSON-RPC response ID (request: \".concat(payload.id, \" / response: \").concat(response.id, \")\"));\n            }\n            if (response.result === undefined) {\n              return new Error('Validation error: Undefined JSON-RPC result');\n            }\n            return true;\n          }\n          return new Error('Validation error: Response should be of type Object');\n        }\n      }]);\n      return JsonRpcResponseValidator;\n    }();\n\n    var AbstractSocketProvider =\n    function (_EventEmitter) {\n      _inherits(AbstractSocketProvider, _EventEmitter);\n      function AbstractSocketProvider(connection, timeout) {\n        var _this;\n        _classCallCheck(this, AbstractSocketProvider);\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(AbstractSocketProvider).call(this));\n        _this.connection = connection;\n        _this.timeout = timeout;\n        _this.subscriptions = new Map();\n        _this.registerEventListeners();\n        _this.READY = 'ready';\n        _this.CONNECT = 'connect';\n        _this.ERROR = 'error';\n        _this.CLOSE = 'close';\n        _this.SOCKET_MESSAGE = 'socket_message';\n        _this.SOCKET_READY = 'socket_ready';\n        _this.SOCKET_CLOSE = 'socket_close';\n        _this.SOCKET_ERROR = 'socket_error';\n        _this.SOCKET_CONNECT = 'socket_connect';\n        _this.SOCKET_NETWORK_CHANGED = 'socket_networkChanged';\n        _this.SOCKET_ACCOUNTS_CHANGED = 'socket_accountsChanged';\n        return _this;\n      }\n      _createClass(AbstractSocketProvider, [{\n        key: \"supportsSubscriptions\",\n        value: function supportsSubscriptions() {\n          return true;\n        }\n      }, {\n        key: \"registerEventListeners\",\n        value: function registerEventListeners() {}\n      }, {\n        key: \"removeAllSocketListeners\",\n        value: function removeAllSocketListeners() {\n          this.removeAllListeners(this.SOCKET_MESSAGE);\n          this.removeAllListeners(this.SOCKET_READY);\n          this.removeAllListeners(this.SOCKET_CLOSE);\n          this.removeAllListeners(this.SOCKET_ERROR);\n          this.removeAllListeners(this.SOCKET_CONNECT);\n        }\n      }, {\n        key: \"disconnect\",\n        value: function disconnect(code, reason) {}\n      }, {\n        key: \"send\",\n        value: function () {\n          var _send = _asyncToGenerator(\n          _regeneratorRuntime.mark(function _callee(method, parameters) {\n            var response, validationResult;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.next = 2;\n                    return this.sendPayload(JsonRpcMapper.toPayload(method, parameters));\n                  case 2:\n                    response = _context.sent;\n                    validationResult = JsonRpcResponseValidator.validate(response);\n                    if (!(validationResult instanceof Error)) {\n                      _context.next = 6;\n                      break;\n                    }\n                    throw validationResult;\n                  case 6:\n                    return _context.abrupt(\"return\", response.result);\n                  case 7:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, this);\n          }));\n          function send(_x, _x2) {\n            return _send.apply(this, arguments);\n          }\n          return send;\n        }()\n      }, {\n        key: \"sendBatch\",\n        value: function sendBatch(methods, moduleInstance) {\n          var payload = [];\n          methods.forEach(function (method) {\n            method.beforeExecution(moduleInstance);\n            payload.push(JsonRpcMapper.toPayload(method.rpcMethod, method.parameters));\n          });\n          return this.sendPayload(payload);\n        }\n      }, {\n        key: \"onReady\",\n        value: function onReady(event) {\n          this.emit(this.READY, event);\n          this.emit(this.SOCKET_READY, event);\n        }\n      }, {\n        key: \"onError\",\n        value: function onError(error) {\n          this.emit(this.ERROR, error);\n          this.emit(this.SOCKET_ERROR, error);\n          this.removeAllSocketListeners();\n        }\n      }, {\n        key: \"onClose\",\n        value: function onClose() {\n          var error = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n          this.emit(this.CLOSE, error);\n          this.emit(this.SOCKET_CLOSE, error);\n          this.removeAllSocketListeners();\n          this.removeAllListeners();\n        }\n      }, {\n        key: \"onConnect\",\n        value: function () {\n          var _onConnect = _asyncToGenerator(\n          _regeneratorRuntime.mark(function _callee2() {\n            var subscriptionId, value, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, item;\n            return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    if (!(this.subscriptions.size > 0)) {\n                      _context2.next = 31;\n                      break;\n                    }\n                    _iteratorNormalCompletion = true;\n                    _didIteratorError = false;\n                    _iteratorError = undefined;\n                    _context2.prev = 4;\n                    _iterator = this.subscriptions[Symbol.iterator]();\n                  case 6:\n                    if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                      _context2.next = 17;\n                      break;\n                    }\n                    item = _step.value;\n                    value = item[1];\n                    _context2.next = 11;\n                    return this.subscribe(value.subscribeMethod, value.parameters[0], value.parameters.slice(1));\n                  case 11:\n                    subscriptionId = _context2.sent;\n                    if (item[0] !== subscriptionId) {\n                      this.subscriptions.delete(subscriptionId);\n                    }\n                    value.id = subscriptionId;\n                  case 14:\n                    _iteratorNormalCompletion = true;\n                    _context2.next = 6;\n                    break;\n                  case 17:\n                    _context2.next = 23;\n                    break;\n                  case 19:\n                    _context2.prev = 19;\n                    _context2.t0 = _context2[\"catch\"](4);\n                    _didIteratorError = true;\n                    _iteratorError = _context2.t0;\n                  case 23:\n                    _context2.prev = 23;\n                    _context2.prev = 24;\n                    if (!_iteratorNormalCompletion && _iterator.return != null) {\n                      _iterator.return();\n                    }\n                  case 26:\n                    _context2.prev = 26;\n                    if (!_didIteratorError) {\n                      _context2.next = 29;\n                      break;\n                    }\n                    throw _iteratorError;\n                  case 29:\n                    return _context2.finish(26);\n                  case 30:\n                    return _context2.finish(23);\n                  case 31:\n                    this.emit(this.SOCKET_CONNECT);\n                    this.emit(this.CONNECT);\n                  case 33:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee2, this, [[4, 19, 23, 31], [24,, 26, 30]]);\n          }));\n          function onConnect() {\n            return _onConnect.apply(this, arguments);\n          }\n          return onConnect;\n        }()\n      }, {\n        key: \"onMessage\",\n        value: function onMessage(response) {\n          var event;\n          if (!isObject(response)) {\n            response = JSON.parse(response);\n          }\n          if (isArray(response)) {\n            event = response[0].id;\n          } else if (typeof response.id === 'undefined') {\n            event = this.getSubscriptionEvent(response.params.subscription);\n            response = response.params;\n          } else {\n            event = response.id;\n          }\n          this.emit(this.SOCKET_MESSAGE, response);\n          this.emit(event, response);\n        }\n      }, {\n        key: \"reset\",\n        value: function reset() {\n          this.removeAllListeners();\n          this.registerEventListeners();\n        }\n      }, {\n        key: \"subscribe\",\n        value: function subscribe(subscribeMethod, subscriptionMethod, parameters) {\n          var _this2 = this;\n          parameters.unshift(subscriptionMethod);\n          return this.send(subscribeMethod, parameters).then(function (subscriptionId) {\n            _this2.subscriptions.set(subscriptionId, {\n              id: subscriptionId,\n              subscribeMethod: subscribeMethod,\n              parameters: parameters\n            });\n            return subscriptionId;\n          }).catch(function (error) {\n            throw new Error(\"Provider error: \".concat(error));\n          });\n        }\n      }, {\n        key: \"unsubscribe\",\n        value: function unsubscribe(subscriptionId, unsubscribeMethod) {\n          var _this3 = this;\n          if (this.hasSubscription(subscriptionId)) {\n            return this.send(unsubscribeMethod, [subscriptionId]).then(function (response) {\n              if (response) {\n                _this3.removeAllListeners(_this3.getSubscriptionEvent(subscriptionId));\n                _this3.subscriptions.delete(subscriptionId);\n              }\n              return response;\n            });\n          }\n          return Promise.reject(new Error(\"Provider error: Subscription with ID \".concat(subscriptionId, \" does not exist.\")));\n        }\n      }, {\n        key: \"clearSubscriptions\",\n        value: function clearSubscriptions() {\n          var _this4 = this;\n          var unsubscribeMethod = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n          if (this.subscriptions.size > 0) {\n            var unsubscribePromises = [];\n            var type = unsubscribeMethod.slice(0, 3);\n            this.subscriptions.forEach(function (value) {\n              if (type === '') {\n                unsubscribePromises.push(_this4.unsubscribe(value.id, \"\".concat(value.subscribeMethod.slice(0, 3), \"_unsubscribe\")));\n              } else if (type === value.subscribeMethod.slice(0, 3)) {\n                unsubscribePromises.push(_this4.unsubscribe(value.id, unsubscribeMethod));\n              }\n            });\n            return Promise.all(unsubscribePromises).then(function (results) {\n              if (results.includes(false)) {\n                throw new Error(\"Could not unsubscribe all subscriptions: \".concat(JSON.stringify(results)));\n              }\n              return true;\n            });\n          }\n          return Promise.resolve(true);\n        }\n      }, {\n        key: \"hasSubscription\",\n        value: function hasSubscription(subscriptionId) {\n          return typeof this.getSubscriptionEvent(subscriptionId) !== 'undefined';\n        }\n      }, {\n        key: \"getSubscriptionEvent\",\n        value: function getSubscriptionEvent(subscriptionId) {\n          if (this.subscriptions.get(subscriptionId)) {\n            return subscriptionId;\n          }\n          var event;\n          this.subscriptions.forEach(function (value, key) {\n            if (value.id === subscriptionId) {\n              event = key;\n            }\n          });\n          return event;\n        }\n      }, {\n        key: \"connected\",\n        get: function get() {}\n      }]);\n      return AbstractSocketProvider;\n    }(EventEmitter);\n\n    var WebsocketProvider =\n    function (_AbstractSocketProvid) {\n      _inherits(WebsocketProvider, _AbstractSocketProvid);\n      function WebsocketProvider(connection, timeout) {\n        var _this;\n        var reconnectDelay = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 5000;\n        _classCallCheck(this, WebsocketProvider);\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(WebsocketProvider).call(this, connection, timeout));\n        _this.host = _this.connection.url;\n        _this.reconnectDelay = reconnectDelay;\n        _this.reconnecting = false;\n        return _this;\n      }\n      _createClass(WebsocketProvider, [{\n        key: \"onConnect\",\n        value: function () {\n          var _onConnect = _asyncToGenerator(\n          _regeneratorRuntime.mark(function _callee() {\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    if (this.reconnecting) {\n                      this.emit('reconnected');\n                    }\n                    _context.next = 3;\n                    return _get(_getPrototypeOf(WebsocketProvider.prototype), \"onConnect\", this).call(this);\n                  case 3:\n                    this.reconnecting = false;\n                  case 4:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, this);\n          }));\n          function onConnect() {\n            return _onConnect.apply(this, arguments);\n          }\n          return onConnect;\n        }()\n      }, {\n        key: \"onMessage\",\n        value: function onMessage(messageEvent) {\n          _get(_getPrototypeOf(WebsocketProvider.prototype), \"onMessage\", this).call(this, messageEvent.data);\n        }\n      }, {\n        key: \"onError\",\n        value: function onError(event) {\n          if (event.code === 'ECONNREFUSED') {\n            this.reconnect();\n            return;\n          }\n          _get(_getPrototypeOf(WebsocketProvider.prototype), \"onError\", this).call(this, event);\n        }\n      }, {\n        key: \"onClose\",\n        value: function onClose(closeEvent) {\n          if (closeEvent.code !== 1000 || closeEvent.wasClean === false) {\n            this.reconnect();\n            return;\n          }\n          _get(_getPrototypeOf(WebsocketProvider.prototype), \"onClose\", this).call(this);\n        }\n      }, {\n        key: \"reconnect\",\n        value: function reconnect() {\n          var _this2 = this;\n          this.reconnecting = true;\n          setTimeout(function () {\n            _this2.removeAllSocketListeners();\n            var connection = [];\n            if (_this2.connection.constructor.name === 'W3CWebSocket') {\n              connection = new _this2.connection.constructor(_this2.host, _this2.connection._client.protocol, null, _this2.connection._client.headers, _this2.connection._client.requestOptions, _this2.connection._client.config);\n            } else {\n              connection = new _this2.connection.constructor(_this2.host, _this2.connection.protocol || undefined);\n            }\n            _this2.connection = connection;\n            _this2.registerEventListeners();\n          }, this.reconnectDelay);\n        }\n      }, {\n        key: \"disconnect\",\n        value: function disconnect() {\n          var code = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n          var reason = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n          this.connection.close(code, reason);\n        }\n      }, {\n        key: \"registerEventListeners\",\n        value: function registerEventListeners() {\n          this.connection.addEventListener('message', this.onMessage.bind(this));\n          this.connection.addEventListener('open', this.onReady.bind(this));\n          this.connection.addEventListener('open', this.onConnect.bind(this));\n          this.connection.addEventListener('close', this.onClose.bind(this));\n          this.connection.addEventListener('error', this.onError.bind(this));\n        }\n      }, {\n        key: \"removeAllListeners\",\n        value: function removeAllListeners(event) {\n          switch (event) {\n            case this.SOCKET_MESSAGE:\n              this.connection.removeEventListener('message', this.onMessage);\n              break;\n            case this.SOCKET_READY:\n              this.connection.removeEventListener('open', this.onReady);\n              break;\n            case this.SOCKET_CLOSE:\n              this.connection.removeEventListener('close', this.onClose);\n              break;\n            case this.SOCKET_ERROR:\n              this.connection.removeEventListener('error', this.onError);\n              break;\n            case this.SOCKET_CONNECT:\n              this.connection.removeEventListener('connect', this.onConnect);\n              break;\n          }\n          _get(_getPrototypeOf(WebsocketProvider.prototype), \"removeAllListeners\", this).call(this, event);\n        }\n      }, {\n        key: \"isConnecting\",\n        value: function isConnecting() {\n          return this.connection.readyState === this.connection.CONNECTING;\n        }\n      }, {\n        key: \"sendPayload\",\n        value: function sendPayload(payload) {\n          var _this3 = this;\n          return new Promise(function (resolve, reject) {\n            _this3.once('error', reject);\n            if (!_this3.isConnecting()) {\n              var timeout, id;\n              if (_this3.connection.readyState !== _this3.connection.OPEN) {\n                _this3.removeListener('error', reject);\n                return reject(new Error('Connection error: Connection is not open on send()'));\n              }\n              try {\n                _this3.connection.send(JSON.stringify(payload));\n              } catch (error) {\n                _this3.removeListener('error', reject);\n                return reject(error);\n              }\n              if (isArray(payload)) {\n                id = payload[0].id;\n              } else {\n                id = payload.id;\n              }\n              if (_this3.timeout) {\n                timeout = setTimeout(function () {\n                  _this3.removeListener('error', reject);\n                  _this3.removeAllListeners(id);\n                  reject(new Error('Connection error: Timeout exceeded'));\n                }, _this3.timeout);\n              }\n              _this3.once(id, function (response) {\n                if (timeout) {\n                  clearTimeout(timeout);\n                }\n                _this3.removeListener('error', reject);\n                return resolve(response);\n              });\n              return;\n            }\n            _this3.once('connect', function () {\n              _this3.sendPayload(payload).then(function (response) {\n                _this3.removeListener('error', reject);\n                return resolve(response);\n              }).catch(function (error) {\n                _this3.removeListener('error', reject);\n                return reject(error);\n              });\n            });\n          });\n        }\n      }, {\n        key: \"connected\",\n        get: function get() {\n          return this.connection.readyState === this.connection.OPEN;\n        }\n      }]);\n      return WebsocketProvider;\n    }(AbstractSocketProvider);\n\n    var IpcProvider =\n    function (_AbstractSocketProvid) {\n      _inherits(IpcProvider, _AbstractSocketProvid);\n      function IpcProvider(connection, path) {\n        var _this;\n        _classCallCheck(this, IpcProvider);\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(IpcProvider).call(this, connection, null));\n        _this.host = path;\n        _this.lastChunk = '';\n        return _this;\n      }\n      _createClass(IpcProvider, [{\n        key: \"disconnect\",\n        value: function disconnect() {\n          this.connection.destroy();\n        }\n      }, {\n        key: \"reconnect\",\n        value: function reconnect() {\n          this.connection.connect({\n            path: this.path\n          });\n        }\n      }, {\n        key: \"onMessage\",\n        value: function onMessage(message) {\n          var _this2 = this;\n          var result = null;\n          var returnValues = [];\n          var dechunkedData = message.toString().replace(/\\}[\\n\\r]?\\{/g, '}|--|{')\n          .replace(/\\}\\][\\n\\r]?\\[\\{/g, '}]|--|[{')\n          .replace(/\\}[\\n\\r]?\\[\\{/g, '}|--|[{')\n          .replace(/\\}\\][\\n\\r]?\\{/g, '}]|--|{')\n          .split('|--|');\n          dechunkedData.forEach(function (data) {\n            result = null;\n            if (_this2.lastChunk) {\n              data = _this2.lastChunk + data;\n            }\n            try {\n              result = JSON.parse(data);\n            } catch (error) {\n              _this2.lastChunk = data;\n              return;\n            }\n            _this2.lastChunk = null;\n            returnValues.push(result);\n          });\n          returnValues.forEach(function (chunk) {\n            _get(_getPrototypeOf(IpcProvider.prototype), \"onMessage\", _this2).call(_this2, chunk);\n          });\n        }\n      }, {\n        key: \"registerEventListeners\",\n        value: function registerEventListeners() {\n          this.connection.on('data', this.onMessage.bind(this));\n          this.connection.on('connect', this.onConnect.bind(this));\n          this.connection.on('error', this.onError.bind(this));\n          this.connection.on('close', this.onClose.bind(this));\n          this.connection.on('timeout', this.onClose.bind(this));\n          this.connection.on('ready', this.onReady.bind(this));\n        }\n      }, {\n        key: \"removeAllListeners\",\n        value: function removeAllListeners(event) {\n          switch (event) {\n            case this.SOCKET_MESSAGE:\n              this.connection.removeListener('data', this.onMessage);\n              break;\n            case this.SOCKET_READY:\n              this.connection.removeListener('ready', this.onReady);\n              break;\n            case this.SOCKET_CLOSE:\n              this.connection.removeListener('close', this.onClose);\n              break;\n            case this.SOCKET_ERROR:\n              this.connection.removeListener('error', this.onError);\n              break;\n            case this.SOCKET_CONNECT:\n              this.connection.removeListener('connect', this.onConnect);\n              break;\n          }\n          _get(_getPrototypeOf(IpcProvider.prototype), \"removeAllListeners\", this).call(this, event);\n        }\n      }, {\n        key: \"sendPayload\",\n        value: function sendPayload(payload) {\n          var _this3 = this;\n          return new Promise(function (resolve, reject) {\n            _this3.once('error', reject);\n            if (!_this3.connection.writable) {\n              _this3.connection.connect({\n                path: _this3.path\n              });\n            }\n            if (_this3.connection.write(JSON.stringify(payload))) {\n              var id;\n              if (isArray(payload)) {\n                id = payload[0].id;\n              } else {\n                id = payload.id;\n              }\n              _this3.once(id, function (response) {\n                resolve(response);\n                _this3.removeListener('error', reject);\n              });\n              return;\n            }\n            _this3.removeListener('error', reject);\n            return reject(new Error(\"Connection error: Couldn't write on the socket with Socket.write(payload)\"));\n          });\n        }\n      }, {\n        key: \"connected\",\n        get: function get() {\n          return !this.connection.pending;\n        }\n      }]);\n      return IpcProvider;\n    }(AbstractSocketProvider);\n\n    var HttpProvider =\n    function () {\n      function HttpProvider() {\n        var host = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'http://localhost:8545';\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n        var providersModuleFactory = arguments.length > 2 ? arguments[2] : undefined;\n        _classCallCheck(this, HttpProvider);\n        this.host = host;\n        this.timeout = options.timeout || 0;\n        this.headers = options.headers;\n        this.withCredentials = options.withCredentials || false;\n        this.connected = true;\n        this.providersModuleFactory = providersModuleFactory;\n        this.agent = {};\n        var keepAlive = false;\n        if (options.keepAlive === true || options.keepAlive !== false) {\n          keepAlive = true;\n        }\n        if (host.substring(0, 5) === 'https') {\n          this.agent['httpsAgent'] = new https.Agent({\n            keepAlive: keepAlive\n          });\n        } else {\n          this.agent['httpAgent'] = new http.Agent({\n            keepAlive: keepAlive\n          });\n        }\n      }\n      _createClass(HttpProvider, [{\n        key: \"supportsSubscriptions\",\n        value: function supportsSubscriptions() {\n          return false;\n        }\n      }, {\n        key: \"subscribe\",\n        value: function subscribe() {\n          throw new Error('Subscriptions are not supported with the HttpProvider.');\n        }\n      }, {\n        key: \"unsubscribe\",\n        value: function unsubscribe() {\n          throw new Error('Subscriptions are not supported with the HttpProvider.');\n        }\n      }, {\n        key: \"disconnect\",\n        value: function disconnect() {\n          return true;\n        }\n      }, {\n        key: \"send\",\n        value: function () {\n          var _send = _asyncToGenerator(\n          _regeneratorRuntime.mark(function _callee(method, parameters) {\n            var response, validationResult;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.next = 2;\n                    return this.sendPayload(JsonRpcMapper.toPayload(method, parameters));\n                  case 2:\n                    response = _context.sent;\n                    validationResult = JsonRpcResponseValidator.validate(response);\n                    if (!(validationResult instanceof Error)) {\n                      _context.next = 6;\n                      break;\n                    }\n                    throw validationResult;\n                  case 6:\n                    return _context.abrupt(\"return\", response.result);\n                  case 7:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, this);\n          }));\n          function send(_x, _x2) {\n            return _send.apply(this, arguments);\n          }\n          return send;\n        }()\n      }, {\n        key: \"sendBatch\",\n        value: function sendBatch(methods, moduleInstance) {\n          var payload = [];\n          methods.forEach(function (method) {\n            method.beforeExecution(moduleInstance);\n            payload.push(JsonRpcMapper.toPayload(method.rpcMethod, method.parameters));\n          });\n          return this.sendPayload(payload);\n        }\n      }, {\n        key: \"sendPayload\",\n        value: function sendPayload(payload) {\n          var _this = this;\n          return new Promise(function (resolve, reject) {\n            var request = _this.providersModuleFactory.createXMLHttpRequest(_this.host, _this.timeout, _this.headers, _this.agent, _this.withCredentials);\n            request.onreadystatechange = function () {\n              if (request.readyState !== 0 && request.readyState !== 1) {\n                _this.connected = true;\n              }\n              if (request.readyState === 4) {\n                if (request.status === 200) {\n                  try {\n                    return resolve(JSON.parse(request.responseText));\n                  } catch (error) {\n                    reject(new Error(\"Invalid JSON as response: \".concat(request.responseText)));\n                  }\n                }\n                if (_this.isInvalidHttpEndpoint(request)) {\n                  reject(new Error(\"Connection refused or URL couldn't be resolved: \".concat(_this.host)));\n                }\n                if (request.status >= 400 && request.status <= 499) {\n                  reject(new Error(\"HttpProvider ERROR: \".concat(request.responseText, \" (code: \").concat(request.status, \")\")));\n                }\n              }\n            };\n            request.ontimeout = function () {\n              _this.connected = false;\n              reject(new Error(\"Connection error: Timeout exceeded after \".concat(_this.timeout, \"ms\")));\n            };\n            try {\n              request.send(JSON.stringify(payload));\n            } catch (error) {\n              _this.connected = false;\n              reject(error);\n            }\n          });\n        }\n      }, {\n        key: \"isInvalidHttpEndpoint\",\n        value: function isInvalidHttpEndpoint(request) {\n          return request.response === null && request.status === 0;\n        }\n      }]);\n      return HttpProvider;\n    }();\n\n    var BatchRequest =\n    function () {\n      function BatchRequest(moduleInstance) {\n        _classCallCheck(this, BatchRequest);\n        this.moduleInstance = moduleInstance;\n        this.methods = [];\n        this.accounts = [];\n      }\n      _createClass(BatchRequest, [{\n        key: \"add\",\n        value: function add(method) {\n          if (!isObject(method) && method) {\n            throw new Error('Please provide a object of type AbstractMethod.');\n          }\n          this.methods.push(method);\n        }\n      }, {\n        key: \"execute\",\n        value: function () {\n          var _execute = _asyncToGenerator(\n          _regeneratorRuntime.mark(function _callee() {\n            var _this = this;\n            var payload, response, hasCallbacks, errors;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.next = 2;\n                    return this.toPayload();\n                  case 2:\n                    payload = _context.sent;\n                    _context.next = 5;\n                    return this.moduleInstance.currentProvider.sendPayload(payload);\n                  case 5:\n                    response = _context.sent;\n                    hasCallbacks = false;\n                    errors = [];\n                    this.methods.forEach(function (method, index) {\n                      if (!hasCallbacks && method.callback) {\n                        hasCallbacks = true;\n                      }\n                      if (!isArray(response)) {\n                        if (method.callback) {\n                          method.callback(new Error(\"BatchRequest error: Response should be of type Array but is: \".concat(_typeof(response))), null);\n                          return;\n                        }\n                        throw new Error(\"BatchRequest error: Response should be of type Array but is: \".concat(_typeof(response)));\n                      }\n                      var responseItem = response[index] || null;\n                      var validationResult = JsonRpcResponseValidator.validate(responseItem);\n                      if (validationResult === true) {\n                        try {\n                          var mappedResult;\n                          if (method.Type === 'eth-send-transaction-method' || method.Type === 'observed-transaction-method') {\n                            mappedResult = responseItem.result;\n                          } else {\n                            mappedResult = method.afterExecution(responseItem.result);\n                          }\n                          response[index] = mappedResult;\n                          if (method.callback) {\n                            method.callback(false, mappedResult);\n                          }\n                        } catch (error) {\n                          errors[index] = {\n                            method: method,\n                            error: error\n                          };\n                          if (method.callback) {\n                            method.callback(error, null);\n                          }\n                        }\n                        return;\n                      }\n                      errors[index] = {\n                        method: method,\n                        error: validationResult\n                      };\n                      if (_this.accounts[index] && _this.accounts[index].nonce) {\n                        _this.accounts[index].nonce--;\n                      }\n                      if (method.callback) {\n                        method.callback(validationResult, null);\n                      }\n                    });\n                    if (!(errors.length > 0 && !hasCallbacks)) {\n                      _context.next = 11;\n                      break;\n                    }\n                    throw {\n                      errors: errors,\n                      response: response\n                    };\n                  case 11:\n                    return _context.abrupt(\"return\", {\n                      methods: this.methods,\n                      response: response\n                    });\n                  case 12:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, this);\n          }));\n          function execute() {\n            return _execute.apply(this, arguments);\n          }\n          return execute;\n        }()\n      }, {\n        key: \"toPayload\",\n        value: function () {\n          var _toPayload = _asyncToGenerator(\n          _regeneratorRuntime.mark(function _callee2() {\n            var payload, i, method, account, response;\n            return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    payload = [];\n                    i = 0;\n                  case 2:\n                    if (!(i < this.methods.length)) {\n                      _context2.next = 18;\n                      break;\n                    }\n                    method = this.methods[i];\n                    method.beforeExecution(this.moduleInstance);\n                    if (!(this.moduleInstance.accounts && method.Type === 'eth-send-transaction-method' && method.hasAccounts())) {\n                      _context2.next = 14;\n                      break;\n                    }\n                    account = this.moduleInstance.accounts.wallet[method.parameters[0].from];\n                    if (!account) {\n                      _context2.next = 14;\n                      break;\n                    }\n                    _context2.next = 10;\n                    return method.signTransaction(account);\n                  case 10:\n                    response = _context2.sent;\n                    method.parameters = [response.rawTransaction];\n                    method.rpcMethod = 'eth_sendRawTransaction';\n                    this.accounts[i] = account;\n                  case 14:\n                    payload.push(JsonRpcMapper.toPayload(method.rpcMethod, method.parameters));\n                  case 15:\n                    i++;\n                    _context2.next = 2;\n                    break;\n                  case 18:\n                    return _context2.abrupt(\"return\", payload);\n                  case 19:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee2, this);\n          }));\n          function toPayload() {\n            return _toPayload.apply(this, arguments);\n          }\n          return toPayload;\n        }()\n      }]);\n      return BatchRequest;\n    }();\n\n    var Web3EthereumProvider =\n    function (_AbstractSocketProvid) {\n      _inherits(Web3EthereumProvider, _AbstractSocketProvid);\n      function Web3EthereumProvider(connection) {\n        var _this;\n        _classCallCheck(this, Web3EthereumProvider);\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(Web3EthereumProvider).call(this, connection, null));\n        _this.host = 'Web3EthereumProvider';\n        return _this;\n      }\n      _createClass(Web3EthereumProvider, [{\n        key: \"registerEventListeners\",\n        value: function registerEventListeners() {\n          this.connection.on('notification', this.onMessage.bind(this));\n          this.connection.on('connect', this.onConnect.bind(this));\n          this.connection.on('connect', this.onReady.bind(this));\n          this.connection.on('close', this.onClose.bind(this));\n          this.connection.on('networkChanged', this.onNetworkChanged.bind(this));\n          this.connection.on('accountsChanged', this.onAccountsChanged.bind(this));\n        }\n      }, {\n        key: \"removeAllListeners\",\n        value: function removeAllListeners(event) {\n          switch (event) {\n            case this.SOCKET_NETWORK_CHANGED:\n              this.connection.removeListener('networkChanged', this.onNetworkChanged);\n              break;\n            case this.SOCKET_ACCOUNTS_CHANGED:\n              this.connection.removeListener('accountsChanged', this.onAccountsChanged);\n              break;\n            case this.SOCKET_MESSAGE:\n              this.connection.removeListener('notification', this.onMessage);\n              break;\n            case this.SOCKET_READY:\n              this.connection.removeListener('connect', this.onReady);\n              break;\n            case this.SOCKET_CLOSE:\n              this.connection.removeListener('close', this.onClose);\n              break;\n            case this.SOCKET_ERROR:\n              this.connection.removeListener('close', this.onError);\n              break;\n            case this.SOCKET_CONNECT:\n              this.connection.removeListener('connect', this.onConnect);\n              break;\n          }\n          _get(_getPrototypeOf(Web3EthereumProvider.prototype), \"removeAllListeners\", this).call(this, event);\n        }\n      }, {\n        key: \"removeAllSocketListeners\",\n        value: function removeAllSocketListeners() {\n          this.removeAllListeners(this.SOCKET_ACCOUNTS_CHANGED);\n          this.removeAllListeners(this.SOCKET_NETWORK_CHANGED);\n          _get(_getPrototypeOf(Web3EthereumProvider.prototype), \"removeAllSocketListeners\", this).call(this);\n        }\n      }, {\n        key: \"onNetworkChanged\",\n        value: function onNetworkChanged(networkId) {\n          this.emit('networkChanged', networkId);\n        }\n      }, {\n        key: \"onAccountsChanged\",\n        value: function onAccountsChanged(accounts) {\n          this.emit('accountsChanged', accounts);\n        }\n      }, {\n        key: \"onMessage\",\n        value: function onMessage(response) {\n          this.emit(this.getSubscriptionEvent(response.subscription), response);\n        }\n      }, {\n        key: \"send\",\n        value: function () {\n          var _send = _asyncToGenerator(\n          _regeneratorRuntime.mark(function _callee(method, parameters) {\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.prev = 0;\n                    _context.next = 3;\n                    return this.connection.send(method, parameters);\n                  case 3:\n                    return _context.abrupt(\"return\", _context.sent);\n                  case 6:\n                    _context.prev = 6;\n                    _context.t0 = _context[\"catch\"](0);\n                    throw new Error(\"Node error: \".concat(_context.t0.message));\n                  case 9:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, this, [[0, 6]]);\n          }));\n          function send(_x, _x2) {\n            return _send.apply(this, arguments);\n          }\n          return send;\n        }()\n      }, {\n        key: \"sendBatch\",\n        value: function sendBatch(methods, moduleInstance) {\n          var _this2 = this;\n          var methodCalls = [];\n          methods.forEach(function (method) {\n            method.beforeExecution(moduleInstance);\n            methodCalls.push(_this2.connection.send(method.rpcMethod, method.parameters));\n          });\n          return Promise.all(methodCalls);\n        }\n      }]);\n      return Web3EthereumProvider;\n    }(AbstractSocketProvider);\n\n    var MetamaskProvider =\n    function (_AbstractSocketProvid) {\n      _inherits(MetamaskProvider, _AbstractSocketProvid);\n      function MetamaskProvider(inpageProvider) {\n        var _this;\n        _classCallCheck(this, MetamaskProvider);\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(MetamaskProvider).call(this, inpageProvider, null));\n        _this.host = 'metamask';\n        return _this;\n      }\n      _createClass(MetamaskProvider, [{\n        key: \"registerEventListeners\",\n        value: function registerEventListeners() {\n          this.connection.on('accountsChanged', this.onAccountsChanged.bind(this));\n          this.connection.on('networkChanged', this.onReady.bind(this));\n          this.connection.on('networkChanged', this.onNetworkChanged.bind(this));\n          this.connection.on('data', this.onMessage.bind(this));\n          this.connection.on('error', this.onError.bind(this));\n        }\n      }, {\n        key: \"onMessage\",\n        value: function onMessage(metamaskParam, payload) {\n          _get(_getPrototypeOf(MetamaskProvider.prototype), \"onMessage\", this).call(this, payload);\n        }\n      }, {\n        key: \"removeAllListeners\",\n        value: function removeAllListeners(event) {\n          switch (event) {\n            case this.SOCKET_NETWORK_CHANGED:\n              this.connection.removeListener('networkChanged', this.onNetworkChanged);\n              break;\n            case this.SOCKET_ACCOUNTS_CHANGED:\n              this.connection.removeListener('accountsChanged', this.onAccountsChanged);\n              break;\n            case this.SOCKET_MESSAGE:\n              this.connection.removeListener('data', this.onMessage);\n              break;\n            case this.SOCKET_ERROR:\n              this.connection.removeListener('error', this.onError);\n              break;\n          }\n          _get(_getPrototypeOf(MetamaskProvider.prototype), \"removeAllListeners\", this).call(this, event);\n        }\n      }, {\n        key: \"removeAllSocketListeners\",\n        value: function removeAllSocketListeners() {\n          this.removeAllListeners(this.SOCKET_ACCOUNTS_CHANGED);\n          this.removeAllListeners(this.SOCKET_NETWORK_CHANGED);\n          _get(_getPrototypeOf(MetamaskProvider.prototype), \"removeAllSocketListeners\", this).call(this);\n        }\n      }, {\n        key: \"onNetworkChanged\",\n        value: function onNetworkChanged(networkId) {\n          this.emit('networkChanged', networkId);\n        }\n      }, {\n        key: \"onAccountsChanged\",\n        value: function onAccountsChanged(accounts) {\n          this.emit('accountsChanged', accounts);\n        }\n      }, {\n        key: \"disconnect\",\n        value: function disconnect() {\n          return true;\n        }\n      }, {\n        key: \"sendPayload\",\n        value: function sendPayload(payload) {\n          var _this2 = this;\n          return new Promise(function (resolve, reject) {\n            _this2.connection.send(payload, function (error, response) {\n              if (!error) {\n                return resolve(response);\n              }\n              reject(error);\n            });\n          });\n        }\n      }, {\n        key: \"connected\",\n        get: function get() {\n          return this.connection.isConnected();\n        }\n      }]);\n      return MetamaskProvider;\n    }(AbstractSocketProvider);\n\n    var MistEthereumProvider =\n    function (_AbstractSocketProvid) {\n      _inherits(MistEthereumProvider, _AbstractSocketProvid);\n      function MistEthereumProvider(connection) {\n        var _this;\n        _classCallCheck(this, MistEthereumProvider);\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(MistEthereumProvider).call(this, connection, null));\n        _this.host = 'mist';\n        return _this;\n      }\n      _createClass(MistEthereumProvider, [{\n        key: \"registerEventListeners\",\n        value: function registerEventListeners() {\n          this.connection.on('data', this.onMessage.bind(this));\n          this.connection.on('error', this.onError.bind(this));\n          this.connection.on('connect', this.onConnect.bind(this));\n          this.connection.on('connect', this.onReady.bind(this));\n          this.connection.on('end', this.onClose.bind(this));\n        }\n      }, {\n        key: \"removeAllListeners\",\n        value: function removeAllListeners(event) {\n          switch (event) {\n            case this.SOCKET_MESSAGE:\n              this.connection.removeListener('data', this.onMessage);\n              break;\n            case this.SOCKET_ERROR:\n              this.connection.removeListener('error', this.onError);\n              break;\n            case this.SOCKET_CONNECT:\n              this.connection.removeListener('connect', this.onConnect);\n              break;\n            case this.SOCKET_READY:\n              this.connection.removeListener('connect', this.onConnect);\n              break;\n            case this.SOCKET_CLOSE:\n              this.connection.removeListener('end', this.onClose);\n              break;\n          }\n          _get(_getPrototypeOf(MistEthereumProvider.prototype), \"removeAllListeners\", this).call(this, event);\n        }\n      }, {\n        key: \"disconnect\",\n        value: function disconnect() {\n          return true;\n        }\n      }, {\n        key: \"sendPayload\",\n        value: function sendPayload(payload) {\n          var _this2 = this;\n          return new Promise(function (resolve, reject) {\n            _this2.connection.send(payload, function (error, response) {\n              if (!error) {\n                return resolve(response);\n              }\n              reject(error);\n            });\n          });\n        }\n      }, {\n        key: \"connected\",\n        get: function get() {\n          return this.connection.isConnected();\n        }\n      }]);\n      return MistEthereumProvider;\n    }(AbstractSocketProvider);\n\n    var CustomProvider =\n    function () {\n      function CustomProvider(connection) {\n        _classCallCheck(this, CustomProvider);\n        this.host = 'CustomProvider';\n        this.connection = connection;\n        this.checkConnectionMethods();\n      }\n      _createClass(CustomProvider, [{\n        key: \"supportsSubscriptions\",\n        value: function supportsSubscriptions() {\n          return false;\n        }\n      }, {\n        key: \"checkConnectionMethods\",\n        value: function checkConnectionMethods() {\n          if (this.connection.send || this.connection.sendAsync) {\n            return true;\n          }\n          throw new Error('Invalid provider injected!');\n        }\n      }, {\n        key: \"subscribe\",\n        value: function subscribe() {\n          throw new Error('Subscriptions are not supported with the CustomProvider.');\n        }\n      }, {\n        key: \"unsubscribe\",\n        value: function unsubscribe() {\n          throw new Error('Subscriptions are not supported with the CustomProvider.');\n        }\n      }, {\n        key: \"send\",\n        value: function () {\n          var _send = _asyncToGenerator(\n          _regeneratorRuntime.mark(function _callee(method, parameters) {\n            var response, validationResult;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.next = 2;\n                    return this.sendPayload(JsonRpcMapper.toPayload(method, parameters));\n                  case 2:\n                    response = _context.sent;\n                    validationResult = JsonRpcResponseValidator.validate(response);\n                    if (!(validationResult instanceof Error)) {\n                      _context.next = 6;\n                      break;\n                    }\n                    throw validationResult;\n                  case 6:\n                    return _context.abrupt(\"return\", response.result);\n                  case 7:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, this);\n          }));\n          function send(_x, _x2) {\n            return _send.apply(this, arguments);\n          }\n          return send;\n        }()\n      }, {\n        key: \"sendBatch\",\n        value: function sendBatch(methods, moduleInstance) {\n          var payload = [];\n          methods.forEach(function (method) {\n            method.beforeExecution(moduleInstance);\n            payload.push(JsonRpcMapper.toPayload(method.rpcMethod, method.parameters));\n          });\n          return this.sendPayload(payload);\n        }\n      }, {\n        key: \"sendPayload\",\n        value: function sendPayload(payload) {\n          var _this = this;\n          return new Promise(function (resolve, reject) {\n            if (_this.connection.sendAsync) {\n              _this.connection.sendAsync(payload, function (error, response) {\n                if (!error) {\n                  resolve(response);\n                }\n                reject(error);\n              });\n              return;\n            }\n            _this.connection.send(payload, function (error, response) {\n              if (!error) {\n                resolve(response);\n              }\n              reject(error);\n            });\n          });\n        }\n      }]);\n      return CustomProvider;\n    }();\n\n    var ProvidersModuleFactory =\n    function () {\n      function ProvidersModuleFactory() {\n        _classCallCheck(this, ProvidersModuleFactory);\n      }\n      _createClass(ProvidersModuleFactory, [{\n        key: \"createBatchRequest\",\n        value: function createBatchRequest(moduleInstance) {\n          return new BatchRequest(moduleInstance);\n        }\n      }, {\n        key: \"createProviderResolver\",\n        value: function createProviderResolver() {\n          return new ProviderResolver(this);\n        }\n      }, {\n        key: \"createHttpProvider\",\n        value: function createHttpProvider(url) {\n          var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n          return new HttpProvider(url, options, this);\n        }\n      }, {\n        key: \"createXMLHttpRequest\",\n        value: function createXMLHttpRequest(host, timeout, headers, agent, withCredentials) {\n          var request;\n          if (typeof process !== 'undefined' && process.versions != null && process.versions.node != null) {\n            request = new xhr2Cookies.XMLHttpRequest();\n            request.nodejsSet(agent);\n          } else {\n            request = new XMLHttpRequest();\n          }\n          request.open('POST', host, true);\n          request.setRequestHeader('Content-Type', 'application/json');\n          request.timeout = timeout;\n          request.withCredentials = withCredentials;\n          if (headers) {\n            headers.forEach(function (header) {\n              request.setRequestHeader(header.name, header.value);\n            });\n          }\n          return request;\n        }\n      }, {\n        key: \"createWebsocketProvider\",\n        value: function createWebsocketProvider(url) {\n          var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n          var headers = options.headers || {};\n          if (typeof process !== 'undefined' && process.versions != null && process.versions.node != null) {\n            var urlObject = new URL(url);\n            if (!headers.authorization && urlObject.username && urlObject.password) {\n              var authToken = Buffer.from(\"\".concat(urlObject.username, \":\").concat(urlObject.password)).toString('base64');\n              headers.authorization = \"Basic \".concat(authToken);\n            }\n          }\n          return new WebsocketProvider(new websocket.w3cwebsocket(url, options.protocol, options.origin, headers, options.requestOptions, options.clientConfig), options.timeout, options.reconnectDelay);\n        }\n      }, {\n        key: \"createIpcProvider\",\n        value: function createIpcProvider(path, net) {\n          return new IpcProvider(net.connect({\n            path: path\n          }), path);\n        }\n      }, {\n        key: \"createWeb3EthereumProvider\",\n        value: function createWeb3EthereumProvider(connection) {\n          return new Web3EthereumProvider(connection);\n        }\n      }, {\n        key: \"createMetamaskProvider\",\n        value: function createMetamaskProvider(inpageProvider) {\n          return new MetamaskProvider(inpageProvider);\n        }\n      }, {\n        key: \"createMistEthereumProvider\",\n        value: function createMistEthereumProvider(mistEthereumProvider) {\n          return new MistEthereumProvider(mistEthereumProvider);\n        }\n      }, {\n        key: \"createCustomProvider\",\n        value: function createCustomProvider(connection) {\n          return new CustomProvider(connection);\n        }\n      }]);\n      return ProvidersModuleFactory;\n    }();\n\n    var global$1 = function () {\n      return this || (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' && self;\n    }() || new Function('return this')();\n    var ProviderDetector =\n    function () {\n      function ProviderDetector() {\n        _classCallCheck(this, ProviderDetector);\n      }\n      _createClass(ProviderDetector, null, [{\n        key: \"detect\",\n        value: function detect() {\n          if (typeof global$1.ethereumProvider !== 'undefined' && global$1.ethereumProvider.constructor.name === 'EthereumProvider') {\n            return global$1.ethereumProvider;\n          }\n          if (typeof global$1.web3 !== 'undefined' && global$1.web3.currentProvider) {\n            return global$1.web3.currentProvider;\n          }\n          return null;\n        }\n      }]);\n      return ProviderDetector;\n    }();\n\n    function HttpProvider$1(url) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new ProvidersModuleFactory().createHttpProvider(url, options);\n    }\n    function WebsocketProvider$1(url) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new ProvidersModuleFactory().createWebsocketProvider(url, options);\n    }\n    function IpcProvider$1(path, net) {\n      return new ProvidersModuleFactory().createIpcProvider(path, net);\n    }\n    function BatchRequest$1(moduleInstance) {\n      return new ProvidersModuleFactory().createBatchRequest(moduleInstance);\n    }\n    function ProviderResolver$1() {\n      return new ProvidersModuleFactory().createProviderResolver();\n    }\n\n    exports.BatchRequest = BatchRequest$1;\n    exports.HttpProvider = HttpProvider$1;\n    exports.IpcProvider = IpcProvider$1;\n    exports.ProviderDetector = ProviderDetector;\n    exports.ProviderResolver = ProviderResolver$1;\n    exports.ProvidersModuleFactory = ProvidersModuleFactory;\n    exports.Web3EthereumProvider = Web3EthereumProvider;\n    exports.WebsocketProvider = WebsocketProvider$1;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n"]},"metadata":{},"sourceType":"script"}