{"ast":null,"code":"// Copyright (c) 2017 Pieter Wuille\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nvar bech32 = require('./bech32');\n\nfunction convertbits(data, frombits, tobits, pad) {\n  var acc = 0;\n  var bits = 0;\n  var ret = [];\n  var maxv = (1 << tobits) - 1;\n\n  for (var p = 0; p < data.length; ++p) {\n    var value = data[p];\n\n    if (value < 0 || value >> frombits !== 0) {\n      return null;\n    }\n\n    acc = acc << frombits | value;\n    bits += frombits;\n\n    while (bits >= tobits) {\n      bits -= tobits;\n      ret.push(acc >> bits & maxv);\n    }\n  }\n\n  if (pad) {\n    if (bits > 0) {\n      ret.push(acc << tobits - bits & maxv);\n    }\n  } else if (bits >= frombits || acc << tobits - bits & maxv) {\n    return null;\n  }\n\n  return ret;\n}\n\nfunction decode(hrp, addr) {\n  var dec = bech32.decode(addr);\n\n  if (dec === null || dec.hrp !== hrp || dec.data.length < 1 || dec.data[0] > 16) {\n    return null;\n  }\n\n  var res = convertbits(dec.data.slice(1), 5, 8, false);\n\n  if (res === null || res.length < 2 || res.length > 40) {\n    return null;\n  }\n\n  if (dec.data[0] === 0 && res.length !== 20 && res.length !== 32) {\n    return null;\n  }\n\n  return {\n    version: dec.data[0],\n    program: res\n  };\n}\n\nfunction encode(hrp, version, program) {\n  var ret = bech32.encode(hrp, [version].concat(convertbits(program, 8, 5, true)));\n\n  if (decode(hrp, ret) === null) {\n    return null;\n  }\n\n  return ret;\n}\n\nfunction isValidAddress(address, hrp) {\n  var hrp = hrp || 'bc';\n  var ret = decode(hrp, address);\n\n  if (ret === null) {\n    hrp = 'tb';\n    ret = decode(hrp, address);\n  }\n\n  if (ret === null) {\n    return false;\n  }\n\n  var recreate = encode(hrp, ret.version, ret.program);\n  return recreate === address.toLowerCase();\n}\n\nmodule.exports = {\n  encode: encode,\n  decode: decode,\n  isValidAddress: isValidAddress\n};","map":{"version":3,"sources":["/home/ryan/dev/defi/shadowtoken2/node_modules/wallet-address-validator/src/crypto/segwit_addr.js"],"names":["bech32","require","convertbits","data","frombits","tobits","pad","acc","bits","ret","maxv","p","length","value","push","decode","hrp","addr","dec","res","slice","version","program","encode","concat","isValidAddress","address","recreate","toLowerCase","module","exports"],"mappings":"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","sourcesContent":["// Copyright (c) 2017 Pieter Wuille\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nvar bech32 = require('./bech32');\n\nfunction convertbits (data, frombits, tobits, pad) {\n  var acc = 0;\n  var bits = 0;\n  var ret = [];\n  var maxv = (1 << tobits) - 1;\n  for (var p = 0; p < data.length; ++p) {\n    var value = data[p];\n    if (value < 0 || (value >> frombits) !== 0) {\n      return null;\n    }\n    acc = (acc << frombits) | value;\n    bits += frombits;\n    while (bits >= tobits) {\n      bits -= tobits;\n      ret.push((acc >> bits) & maxv);\n    }\n  }\n  if (pad) {\n    if (bits > 0) {\n      ret.push((acc << (tobits - bits)) & maxv);\n    }\n  } else if (bits >= frombits || ((acc << (tobits - bits)) & maxv)) {\n    return null;\n  }\n  return ret;\n}\n\nfunction decode (hrp, addr) {\n  var dec = bech32.decode(addr);\n  if (dec === null || dec.hrp !== hrp || dec.data.length < 1 || dec.data[0] > 16) {\n    return null;\n  }\n  var res = convertbits(dec.data.slice(1), 5, 8, false);\n  if (res === null || res.length < 2 || res.length > 40) {\n    return null;\n  }\n  if (dec.data[0] === 0 && res.length !== 20 && res.length !== 32) {\n    return null;\n  }\n  return {version: dec.data[0], program: res};\n}\n\nfunction encode (hrp, version, program) {\n  var ret = bech32.encode(hrp, [version].concat(convertbits(program, 8, 5, true)));\n  if (decode(hrp, ret) === null) {\n    return null;\n  }\n  return ret;\n}\n\nfunction isValidAddress(address, hrp) {\n    var hrp = hrp || 'bc';\n    var ret = decode(hrp, address);\n\n    if (ret === null) {\n        hrp = 'tb';\n        ret = decode(hrp, address);\n    }\n\n    if (ret === null) {\n        return false;\n    }\n\n    var recreate = encode(hrp, ret.version, ret.program);\n    return recreate === address.toLowerCase();\n}\n\nmodule.exports = {\n    encode: encode,\n    decode: decode,\n    isValidAddress: isValidAddress,\n};\n"]},"metadata":{},"sourceType":"script"}