{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getUTXO = exports.getConfirmations = exports.getUTXOs = exports.ZECHandler = exports._apiFallbacks = void 0;\n\nconst bitcoin = __importStar(require(\"bitgo-utxo-lib\"));\n\nconst bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\n\nconst immutable_1 = require(\"immutable\");\n\nconst insight_1 = require(\"../../common/apis/insight\");\n\nconst sochain_1 = require(\"../../common/apis/sochain\");\n\nconst bitgoUtxoLib_1 = require(\"../../common/libraries/bitgoUtxoLib\");\n\nconst confirmations_1 = require(\"../../lib/confirmations\");\n\nconst promiEvent_1 = require(\"../../lib/promiEvent\");\n\nconst retry_1 = require(\"../../lib/retry\");\n\nconst utils_1 = require(\"../../lib/utils\");\n\nvar InsightEndpoints;\n\n(function (InsightEndpoints) {\n  InsightEndpoints[\"TestnetZCash\"] = \"https://explorer.testnet.z.cash/api/\";\n  InsightEndpoints[\"ZCash\"] = \"https://explorer.z.cash/api/\";\n  InsightEndpoints[\"ZecChain\"] = \"https://zechain.net/api/v1/\";\n  InsightEndpoints[\"BlockExplorer\"] = \"https://zcash.blockexplorer.com/api/\";\n  InsightEndpoints[\"ZecBlockExplorer\"] = \"https://zecblockexplorer.com/api/\";\n})(InsightEndpoints || (InsightEndpoints = {}));\n\nexports._apiFallbacks = {\n  fetchConfirmations: (testnet, txHash) => testnet ? [() => insight_1.Insight.fetchConfirmations(InsightEndpoints.TestnetZCash)(txHash)] : [() => insight_1.Insight.fetchConfirmations(InsightEndpoints.ZCash)(txHash), () => insight_1.Insight.fetchConfirmations(InsightEndpoints.ZecChain)(txHash), () => insight_1.Insight.fetchConfirmations(InsightEndpoints.BlockExplorer)(txHash), () => insight_1.Insight.fetchConfirmations(InsightEndpoints.ZecBlockExplorer)(txHash)],\n  fetchUTXO: (testnet, txHash, vOut) => testnet ? [() => insight_1.Insight.fetchUTXO(InsightEndpoints.TestnetZCash)(txHash, vOut)] : [() => insight_1.Insight.fetchUTXO(InsightEndpoints.ZCash)(txHash, vOut), () => insight_1.Insight.fetchUTXO(InsightEndpoints.ZecChain)(txHash, vOut), () => insight_1.Insight.fetchUTXO(InsightEndpoints.BlockExplorer)(txHash, vOut), () => insight_1.Insight.fetchUTXO(InsightEndpoints.ZecBlockExplorer)(txHash, vOut)],\n  fetchUTXOs: (testnet, address, confirmations) => testnet ? [() => insight_1.Insight.fetchUTXOs(InsightEndpoints.TestnetZCash)(address, confirmations), () => sochain_1.Sochain.fetchUTXOs(\"ZECTEST\")(address, confirmations)] : [...utils_1.shuffleArray([() => insight_1.Insight.fetchUTXOs(InsightEndpoints.ZCash)(address, confirmations), () => insight_1.Insight.fetchUTXOs(InsightEndpoints.ZecChain)(address, confirmations), // () => Insight.fetchUTXOs(InsightEndpoints.BlockExplorer)(address, confirmations),\n  () => insight_1.Insight.fetchUTXOs(InsightEndpoints.ZecBlockExplorer)(address, confirmations)]), () => sochain_1.Sochain.fetchUTXOs(\"ZEC\")(address, confirmations)],\n  broadcastTransaction: (testnet, hex) => testnet ? [() => insight_1.Insight.broadcastTransaction(InsightEndpoints.TestnetZCash)(hex), () => sochain_1.Sochain.broadcastTransaction(\"ZECTEST\")(hex)] : [() => insight_1.Insight.broadcastTransaction(InsightEndpoints.ZCash)(hex), () => insight_1.Insight.broadcastTransaction(InsightEndpoints.ZecChain)(hex), () => insight_1.Insight.broadcastTransaction(InsightEndpoints.BlockExplorer)(hex), () => insight_1.Insight.broadcastTransaction(InsightEndpoints.ZecBlockExplorer)(hex), () => sochain_1.Sochain.broadcastTransaction(\"ZEC\")(hex)]\n};\n\nclass ZECHandler {\n  constructor(privateKey, network) {\n    this.decimals = 8; // Returns whether or not this can handle the asset\n\n    this.handlesAsset = asset => typeof asset === \"string\" && [\"ZEC\", \"ZCASH\"].indexOf(asset.toUpperCase()) !== -1;\n\n    this.address = async (asset, options) => this.privateKey.getAddress(); // Balance\n\n\n    this.getBalance = async (asset, options) => (await this.getBalanceInSats(asset, options)).dividedBy(new bignumber_js_1.default(10).exponentiatedBy(this.decimals));\n\n    this.getBalanceInSats = async (asset, options) => {\n      const utxos = await exports.getUTXOs(this.testnet, Object.assign(Object.assign({}, options), {\n        address: options && options.address || (await this.address(asset))\n      }));\n      return utxos.reduce((sum, utxo) => sum.plus(utxo.amount), new bignumber_js_1.default(0));\n    }; // Transfer\n\n\n    this.send = (to, value, asset, options) => this.sendSats(to, value.times(new bignumber_js_1.default(10).exponentiatedBy(this.decimals)), asset, options);\n\n    this.sendSats = (to, valueIn, asset, options) => {\n      const promiEvent = promiEvent_1.newPromiEvent();\n      let txHash;\n      let errored;\n      (async () => {\n        const fromAddress = await this.address(asset);\n        const changeAddress = fromAddress;\n        const utxos = immutable_1.List(await exports.getUTXOs(this.testnet, Object.assign(Object.assign({}, options), {\n          address: fromAddress\n        }))).sortBy(utxo => utxo.amount).reverse().toArray();\n\n        if (this.testnet) {\n          // tslint:disable-next-line: no-object-mutation\n          bitcoin.networks.zcashTest.consensusBranchId[\"4\"] = 0xf5b9230b;\n        }\n\n        const built = await bitgoUtxoLib_1.BitgoUTXOLib.buildUTXO(this.testnet ? bitcoin.networks.zcashTest : bitcoin.networks.zcash, this.privateKey, changeAddress, to, valueIn, utxos, Object.assign(Object.assign({}, options), {\n          version: 4,\n          versionGroupID: this.testnet ? 0xf5b9230b : 0x892F2085\n        }));\n        txHash = await retry_1.retryNTimes(() => retry_1.fallback(exports._apiFallbacks.broadcastTransaction(this.testnet, built.toHex())), 3);\n        promiEvent.emit('transactionHash', txHash);\n        promiEvent.resolve(txHash);\n      })().catch(error => {\n        errored = true;\n        promiEvent.reject(error);\n      });\n      confirmations_1.subscribeToConfirmations(promiEvent, () => errored, async () => txHash ? this._getConfirmations(txHash) : 0);\n      return promiEvent;\n    };\n\n    this._getConfirmations = txHash => retry_1.retryNTimes(() => retry_1.fallback(exports._apiFallbacks.fetchConfirmations(this.testnet, txHash)), 2);\n\n    this.testnet = network !== \"mainnet\";\n    this.privateKey = bitgoUtxoLib_1.BitgoUTXOLib.loadPrivateKey(this.testnet ? bitcoin.networks.zcashTest : bitcoin.networks.zcash, privateKey);\n  }\n\n}\n\nexports.ZECHandler = ZECHandler;\n\nexports.getUTXOs = async (testnet, options) => {\n  const confirmations = options && options.confirmations !== undefined ? options.confirmations : 0;\n  return retry_1.retryNTimes(() => retry_1.fallback(exports._apiFallbacks.fetchUTXOs(testnet, options.address, confirmations)), 2);\n};\n\nexports.getConfirmations = async (testnet, txHash) => {\n  const endpoints = exports._apiFallbacks.fetchConfirmations(testnet, txHash);\n\n  return retry_1.retryNTimes(() => retry_1.fallback(endpoints), 2);\n};\n\nexports.getUTXO = async (testnet, txHash, vOut) => {\n  const endpoints = exports._apiFallbacks.fetchUTXO(testnet, txHash, vOut);\n\n  return retry_1.retryNTimes(() => retry_1.fallback(endpoints), 2);\n};","map":{"version":3,"sources":["../../../../src/handlers/ZEC/ZECHandler.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getUTXO = exports.getConfirmations = exports.getUTXOs = exports.ZECHandler = exports._apiFallbacks = void 0;\nconst bitcoin = __importStar(require(\"bitgo-utxo-lib\"));\nconst bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\nconst immutable_1 = require(\"immutable\");\nconst insight_1 = require(\"../../common/apis/insight\");\nconst sochain_1 = require(\"../../common/apis/sochain\");\nconst bitgoUtxoLib_1 = require(\"../../common/libraries/bitgoUtxoLib\");\nconst confirmations_1 = require(\"../../lib/confirmations\");\nconst promiEvent_1 = require(\"../../lib/promiEvent\");\nconst retry_1 = require(\"../../lib/retry\");\nconst utils_1 = require(\"../../lib/utils\");\nvar InsightEndpoints;\n(function (InsightEndpoints) {\n    InsightEndpoints[\"TestnetZCash\"] = \"https://explorer.testnet.z.cash/api/\";\n    InsightEndpoints[\"ZCash\"] = \"https://explorer.z.cash/api/\";\n    InsightEndpoints[\"ZecChain\"] = \"https://zechain.net/api/v1/\";\n    InsightEndpoints[\"BlockExplorer\"] = \"https://zcash.blockexplorer.com/api/\";\n    InsightEndpoints[\"ZecBlockExplorer\"] = \"https://zecblockexplorer.com/api/\";\n})(InsightEndpoints || (InsightEndpoints = {}));\nexports._apiFallbacks = {\n    fetchConfirmations: (testnet, txHash) => testnet ?\n        [\n            () => insight_1.Insight.fetchConfirmations(InsightEndpoints.TestnetZCash)(txHash),\n        ] : [\n        () => insight_1.Insight.fetchConfirmations(InsightEndpoints.ZCash)(txHash),\n        () => insight_1.Insight.fetchConfirmations(InsightEndpoints.ZecChain)(txHash),\n        () => insight_1.Insight.fetchConfirmations(InsightEndpoints.BlockExplorer)(txHash),\n        () => insight_1.Insight.fetchConfirmations(InsightEndpoints.ZecBlockExplorer)(txHash),\n    ],\n    fetchUTXO: (testnet, txHash, vOut) => testnet ?\n        [\n            () => insight_1.Insight.fetchUTXO(InsightEndpoints.TestnetZCash)(txHash, vOut),\n        ] : [\n        () => insight_1.Insight.fetchUTXO(InsightEndpoints.ZCash)(txHash, vOut),\n        () => insight_1.Insight.fetchUTXO(InsightEndpoints.ZecChain)(txHash, vOut),\n        () => insight_1.Insight.fetchUTXO(InsightEndpoints.BlockExplorer)(txHash, vOut),\n        () => insight_1.Insight.fetchUTXO(InsightEndpoints.ZecBlockExplorer)(txHash, vOut),\n    ],\n    fetchUTXOs: (testnet, address, confirmations) => testnet ? [\n        () => insight_1.Insight.fetchUTXOs(InsightEndpoints.TestnetZCash)(address, confirmations),\n        () => sochain_1.Sochain.fetchUTXOs(\"ZECTEST\")(address, confirmations),\n    ] : [\n        ...utils_1.shuffleArray([\n            () => insight_1.Insight.fetchUTXOs(InsightEndpoints.ZCash)(address, confirmations),\n            () => insight_1.Insight.fetchUTXOs(InsightEndpoints.ZecChain)(address, confirmations),\n            // () => Insight.fetchUTXOs(InsightEndpoints.BlockExplorer)(address, confirmations),\n            () => insight_1.Insight.fetchUTXOs(InsightEndpoints.ZecBlockExplorer)(address, confirmations),\n        ]),\n        () => sochain_1.Sochain.fetchUTXOs(\"ZEC\")(address, confirmations),\n    ],\n    broadcastTransaction: (testnet, hex) => testnet ?\n        [\n            () => insight_1.Insight.broadcastTransaction(InsightEndpoints.TestnetZCash)(hex),\n            () => sochain_1.Sochain.broadcastTransaction(\"ZECTEST\")(hex),\n        ] : [\n        () => insight_1.Insight.broadcastTransaction(InsightEndpoints.ZCash)(hex),\n        () => insight_1.Insight.broadcastTransaction(InsightEndpoints.ZecChain)(hex),\n        () => insight_1.Insight.broadcastTransaction(InsightEndpoints.BlockExplorer)(hex),\n        () => insight_1.Insight.broadcastTransaction(InsightEndpoints.ZecBlockExplorer)(hex),\n        () => sochain_1.Sochain.broadcastTransaction(\"ZEC\")(hex),\n    ],\n};\nclass ZECHandler {\n    constructor(privateKey, network) {\n        this.decimals = 8;\n        // Returns whether or not this can handle the asset\n        this.handlesAsset = (asset) => typeof asset === \"string\" && [\"ZEC\", \"ZCASH\"].indexOf(asset.toUpperCase()) !== -1;\n        this.address = async (asset, options) => this.privateKey.getAddress();\n        // Balance\n        this.getBalance = async (asset, options) => (await this.getBalanceInSats(asset, options)).dividedBy(new bignumber_js_1.default(10).exponentiatedBy(this.decimals));\n        this.getBalanceInSats = async (asset, options) => {\n            const utxos = await exports.getUTXOs(this.testnet, Object.assign(Object.assign({}, options), { address: options && options.address || await this.address(asset) }));\n            return utxos.reduce((sum, utxo) => sum.plus(utxo.amount), new bignumber_js_1.default(0));\n        };\n        // Transfer\n        this.send = (to, value, asset, options) => this.sendSats(to, value.times(new bignumber_js_1.default(10).exponentiatedBy(this.decimals)), asset, options);\n        this.sendSats = (to, valueIn, asset, options) => {\n            const promiEvent = promiEvent_1.newPromiEvent();\n            let txHash;\n            let errored;\n            (async () => {\n                const fromAddress = await this.address(asset);\n                const changeAddress = fromAddress;\n                const utxos = immutable_1.List(await exports.getUTXOs(this.testnet, Object.assign(Object.assign({}, options), { address: fromAddress }))).sortBy(utxo => utxo.amount).reverse().toArray();\n                if (this.testnet) {\n                    // tslint:disable-next-line: no-object-mutation\n                    bitcoin.networks.zcashTest.consensusBranchId[\"4\"] = 0xf5b9230b;\n                }\n                const built = await bitgoUtxoLib_1.BitgoUTXOLib.buildUTXO(this.testnet ? bitcoin.networks.zcashTest : bitcoin.networks.zcash, this.privateKey, changeAddress, to, valueIn, utxos, Object.assign(Object.assign({}, options), { version: 4, versionGroupID: this.testnet ? 0xf5b9230b : 0x892F2085 }));\n                txHash = await retry_1.retryNTimes(() => retry_1.fallback(exports._apiFallbacks.broadcastTransaction(this.testnet, built.toHex())), 3);\n                promiEvent.emit('transactionHash', txHash);\n                promiEvent.resolve(txHash);\n            })().catch((error) => { errored = true; promiEvent.reject(error); });\n            confirmations_1.subscribeToConfirmations(promiEvent, () => errored, async () => txHash ? this._getConfirmations(txHash) : 0);\n            return promiEvent;\n        };\n        this._getConfirmations = (txHash) => retry_1.retryNTimes(() => retry_1.fallback(exports._apiFallbacks.fetchConfirmations(this.testnet, txHash)), 2);\n        this.testnet = network !== \"mainnet\";\n        this.privateKey = bitgoUtxoLib_1.BitgoUTXOLib.loadPrivateKey(this.testnet ? bitcoin.networks.zcashTest : bitcoin.networks.zcash, privateKey);\n    }\n}\nexports.ZECHandler = ZECHandler;\nexports.getUTXOs = async (testnet, options) => {\n    const confirmations = options && options.confirmations !== undefined ? options.confirmations : 0;\n    return retry_1.retryNTimes(() => retry_1.fallback(exports._apiFallbacks.fetchUTXOs(testnet, options.address, confirmations)), 2);\n};\nexports.getConfirmations = async (testnet, txHash) => {\n    const endpoints = exports._apiFallbacks.fetchConfirmations(testnet, txHash);\n    return retry_1.retryNTimes(() => retry_1.fallback(endpoints), 2);\n};\nexports.getUTXO = async (testnet, txHash, vOut) => {\n    const endpoints = exports._apiFallbacks.fetchUTXO(testnet, txHash, vOut);\n    return retry_1.retryNTimes(() => retry_1.fallback(endpoints), 2);\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWkVDSGFuZGxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9oYW5kbGVycy9aRUMvWkVDSGFuZGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsd0RBQTBDO0FBRTFDLGdFQUFxQztBQUNyQyx5Q0FBaUM7QUFFakMsdURBQW9EO0FBQ3BELHVEQUFvRDtBQUNwRCxzRUFBbUU7QUFDbkUsMkRBQW1FO0FBQ25FLHFEQUFpRTtBQUNqRSwyQ0FBd0Q7QUFDeEQsMkNBQStDO0FBYy9DLElBQUssZ0JBTUo7QUFORCxXQUFLLGdCQUFnQjtJQUNqQix5RUFBcUQsQ0FBQTtJQUNyRCwwREFBc0MsQ0FBQTtJQUN0Qyw0REFBd0MsQ0FBQTtJQUN4QywwRUFBc0QsQ0FBQTtJQUN0RCwwRUFBc0QsQ0FBQTtBQUMxRCxDQUFDLEVBTkksZ0JBQWdCLEtBQWhCLGdCQUFnQixRQU1wQjtBQUVZLFFBQUEsYUFBYSxHQUFHO0lBQ3pCLGtCQUFrQixFQUFFLENBQUMsT0FBZ0IsRUFBRSxNQUFjLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQy9EO1lBQ0ksR0FBRyxFQUFFLENBQUMsaUJBQU8sQ0FBQyxrQkFBa0IsQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLENBQUMsQ0FBQyxNQUFNLENBQUM7U0FDMUUsQ0FBQyxDQUFDLENBQUM7UUFDQSxHQUFHLEVBQUUsQ0FBQyxpQkFBTyxDQUFDLGtCQUFrQixDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sQ0FBQztRQUNoRSxHQUFHLEVBQUUsQ0FBQyxpQkFBTyxDQUFDLGtCQUFrQixDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDLE1BQU0sQ0FBQztRQUNuRSxHQUFHLEVBQUUsQ0FBQyxpQkFBTyxDQUFDLGtCQUFrQixDQUFDLGdCQUFnQixDQUFDLGFBQWEsQ0FBQyxDQUFDLE1BQU0sQ0FBQztRQUN4RSxHQUFH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"]},"metadata":{},"sourceType":"script"}