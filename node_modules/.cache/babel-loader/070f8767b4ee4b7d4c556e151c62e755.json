{"ast":null,"code":"// Modified from web3-core-method\n\n/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n\n/**\n * @file PromiEvent.js\n * @author Fabian Vogelsteller <fabian@ethereum.org>, Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n// tslint:disable: no-any\nimport { EventEmitter } from \"events\";\nexport class InternalPromiEvent {\n  /**\n   * @constructor\n   */\n  constructor() {\n    // tslint:disable-next-line: promise-must-complete\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n    });\n    this._cancelled = false;\n    this.eventEmitter = new EventEmitter();\n    return new Proxy(this, {\n      get: this.proxyHandler\n    });\n  }\n  /**\n   * Proxy handler to call the promise or eventEmitter methods\n   */\n\n\n  proxyHandler(target, name) {\n    if (name === \"resolve\" || name === \"reject\") {\n      return target[name];\n    }\n\n    if (name === \"then\") {\n      return target.promise.then.bind(target.promise);\n    }\n\n    if (name === \"catch\") {\n      return target.promise.catch.bind(target.promise);\n    }\n\n    if (name === \"_cancel\") {\n      // tslint:disable-next-line: no-object-mutation\n      return () => {\n        this._cancelled = true;\n      };\n    }\n\n    if (name === \"_isCancelled\") {\n      // tslint:disable-next-line: no-object-mutation\n      return () => this._cancelled === true;\n    } // tslint:disable-next-line: no-if-statement\n\n\n    if (target.eventEmitter[name]) {\n      return target.eventEmitter[name];\n    }\n  }\n\n}\nexport const newPromiEvent = () => new InternalPromiEvent();","map":{"version":3,"sources":["../../src/promiEvent.ts"],"names":[],"mappings":"AAAA;;AAEA;;;;;;;;;;;;;;;;;AAgBA;;;;;AAMA;AAEA,SAAS,YAAT,QAA6B,QAA7B;AAEA,OAAM,MAAO,kBAAP,CAAyB;AA6B3B;;;AAGA,EAAA,WAAA,GAAA;AACI;AACA,SAAK,OAAL,GAAe,IAAI,OAAJ,CAAe,CAAC,OAAD,EAAU,MAAV,KAAoB;AAC9C,WAAK,OAAL,GAAe,OAAf;AACA,WAAK,MAAL,GAAc,MAAd;AACH,KAHc,CAAf;AAKA,SAAK,UAAL,GAAkB,KAAlB;AAEA,SAAK,YAAL,GAAoB,IAAI,YAAJ,EAApB;AAEA,WAAO,IAAI,KAAJ,CAAU,IAAV,EAAgB;AACnB,MAAA,GAAG,EAAE,KAAK;AADS,KAAhB,CAAP;AAGH;AAED;;;;;AAGO,EAAA,YAAY,CAAC,MAAD,EAAoC,IAApC,EAAgD;AAC/D,QAAI,IAAI,KAAK,SAAT,IAAsB,IAAI,KAAK,QAAnC,EAA6C;AACzC,aAAO,MAAM,CAAC,IAAD,CAAb;AACH;;AAED,QAAI,IAAI,KAAK,MAAb,EAAqB;AACjB,aAAO,MAAM,CAAC,OAAP,CAAe,IAAf,CAAoB,IAApB,CAAyB,MAAM,CAAC,OAAhC,CAAP;AACH;;AAED,QAAI,IAAI,KAAK,OAAb,EAAsB;AAClB,aAAO,MAAM,CAAC,OAAP,CAAe,KAAf,CAAqB,IAArB,CAA0B,MAAM,CAAC,OAAjC,CAAP;AACH;;AAED,QAAI,IAAI,KAAK,SAAb,EAAwB;AACpB;AACA,aAAO,MAAK;AAAG,aAAK,UAAL,GAAkB,IAAlB;AAAyB,OAAxC;AACH;;AAED,QAAI,IAAI,KAAK,cAAb,EAA6B;AACzB;AACA,aAAO,MAAM,KAAK,UAAL,KAAoB,IAAjC;AACH,KArB8D,CAuB/D;;;AACA,QAAK,MAAM,CAAC,YAAP,CAA4B,IAA5B,CAAL,EAAwC;AACpC,aAAQ,MAAM,CAAC,YAAP,CAA4B,IAA5B,CAAR;AACH;AACJ;;AA9E0B;AAmF/B,OAAO,MAAM,aAAa,GAAG,MAA6D,IAAI,kBAAJ,EAAnF","sourceRoot":"","sourcesContent":["// Modified from web3-core-method\n/*\n    This file is part of web3.js.\n\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file PromiEvent.js\n * @author Fabian Vogelsteller <fabian@ethereum.org>, Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n// tslint:disable: no-any\nimport { EventEmitter } from \"events\";\nexport class InternalPromiEvent {\n    /**\n     * @constructor\n     */\n    constructor() {\n        // tslint:disable-next-line: promise-must-complete\n        this.promise = new Promise((resolve, reject) => {\n            this.resolve = resolve;\n            this.reject = reject;\n        });\n        this._cancelled = false;\n        this.eventEmitter = new EventEmitter();\n        return new Proxy(this, {\n            get: this.proxyHandler\n        });\n    }\n    /**\n     * Proxy handler to call the promise or eventEmitter methods\n     */\n    proxyHandler(target, name) {\n        if (name === \"resolve\" || name === \"reject\") {\n            return target[name];\n        }\n        if (name === \"then\") {\n            return target.promise.then.bind(target.promise);\n        }\n        if (name === \"catch\") {\n            return target.promise.catch.bind(target.promise);\n        }\n        if (name === \"_cancel\") {\n            // tslint:disable-next-line: no-object-mutation\n            return () => { this._cancelled = true; };\n        }\n        if (name === \"_isCancelled\") {\n            // tslint:disable-next-line: no-object-mutation\n            return () => this._cancelled === true;\n        }\n        // tslint:disable-next-line: no-if-statement\n        if (target.eventEmitter[name]) {\n            return target.eventEmitter[name];\n        }\n    }\n}\nexport const newPromiEvent = () => new InternalPromiEvent();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvbWlFdmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wcm9taUV2ZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLGlDQUFpQztBQUVqQzs7Ozs7Ozs7Ozs7Ozs7O0VBZUU7QUFDRjs7OztHQUlHO0FBRUgseUJBQXlCO0FBRXpCLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFFdEMsTUFBTSxPQUFPLGtCQUFrQjtJQTZCM0I7O09BRUc7SUFDSDtRQUNJLGtEQUFrRDtRQUNsRCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksT0FBTyxDQUFJLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQzlDLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1lBQ3ZCLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQ3pCLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7UUFFeEIsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRXZDLE9BQU8sSUFBSSxLQUFLLENBQUMsSUFBSSxFQUFFO1lBQ25CLEdBQUcsRUFBRSxJQUFJLENBQUMsWUFBWTtTQUN6QixDQUFDLENBQUM7SUFDUCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxZQUFZLENBQUMsTUFBaUMsRUFBRSxJQUFZO1FBQy9ELElBQUksSUFBSSxLQUFLLFNBQVMsSUFBSSxJQUFJLEtBQUssUUFBUSxFQUFFO1lBQ3pDLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3ZCO1FBRUQsSUFBSSxJQUFJLEtBQUssTUFBTSxFQUFFO1lBQ2pCLE9BQU8sTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUNuRDtRQUVELElBQUksSUFBSSxLQUFLLE9BQU8sRUFBRTtZQUNsQixPQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDcEQ7UUFFRCxJQUFJLElBQUksS0FBSyxTQUFTLEVBQUU7WUFDcEIsK0NBQStDO1lBQy9DLE9BQU8sR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDNUM7UUFFRCxJQUFJLElBQUksS0FBSyxjQUFjLEVBQUU7WUFDekIsK0NBQStDO1lBQy9DLE9BQU8sR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFVBQVUsS0FBSyxJQUFJLENBQUM7U0FDekM7UUFFRCw0Q0FBNEM7UUFDNUMsSUFBSyxNQUFNLENBQUMsWUFBb0IsQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNwQyxPQUFRLE1BQU0sQ0FBQyxZQUFvQixDQUFDLElBQUksQ0FBQyxDQUFDO1NBQzdDO0lBQ0wsQ0FBQztDQUNKO0FBSUQsTUFBTSxDQUFDLE1BQU0sYUFBYSxHQUFHLEdBQTBELEVBQUUsQ0FBQyxJQUFJLGtCQUFrQixFQUE4QyxDQUFDIn0="]},"metadata":{},"sourceType":"module"}